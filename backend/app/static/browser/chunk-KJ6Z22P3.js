import{a as Ae,c as Ve,f as Be,o as je}from"./chunk-L4RQEMSP.js";import{$ as we,A as h,Ba as I,Ca as R,Da as U,Ea as Fe,Fa as Le,Ga as P,H as T,I as Me,Ia as Re,J as l,Ja as ge,Ka as $,L as y,M as O,N as Oe,Na as Ue,P as ke,Qa as X,R as f,Ra as $e,T as ce,Ta as J,U as c,V as de,W as pe,Y as o,Z as a,_ as g,a as he,aa as x,b as _e,ba as m,ca as p,d as j,da as Se,e as G,ea as Te,f as F,fa as Ee,g as M,ga as K,ha as d,i as w,ia as v,ja as k,k as fe,l as ve,la as D,m as be,ma as H,n as ye,na as N,o as Ce,p as xe,pa as me,q as b,qa as E,r as le,ra as Ie,sa as Y,ta as Q,u as L,ua as ze,v as Pe,x as A,z as u}from"./chunk-7N4HMWCM.js";var De=r=>["uil",r];function Ge(r,e){if(r&1&&(o(0,"li",9)(1,"div",10),g(2,"i",11),o(3,"span",12),d(4),a()()()),r&2){let t=e.$implicit;c("routerLink",t.router),l(),ce("data-tooltip",t.name),l(),c("ngClass",me(4,De,t.icon)),l(2),v(t.name)}}function Ke(r,e){if(r&1&&(o(0,"li",9)(1,"div",10),g(2,"i",11),o(3,"span",12),d(4),a()()()),r&2){let t=e.$implicit;c("routerLink",t.router),l(),ce("data-tooltip",t.name),l(),c("ngClass",me(4,De,t.icon)),l(2),v(t.name)}}function Ye(r,e){if(r&1&&(o(0,"li")(1,"div",10)(2,"span",12),d(3),a()()()),r&2){let t=e.$implicit;l(3),v(t.name)}}var Z=class r{constructor(e){this.router=e}mainMenu={defaultOptions:[],accessLink:[]};customOptions=[];ngOnInit(){this.mainMenu.defaultOptions=[{name:"Home",icon:"uil uil-estate",router:["/home"]},{name:"Buscar",icon:"uil uil-search",router:["/home/history"]},{name:"Tu biblioteca",icon:"uil uil-chart",router:["/home/favorites"]}],this.mainMenu.accessLink=[{name:"Crear lista",icon:"uil-plus-square"},{name:"Canciones que te gustan",icon:"uil-heart-medical",router:["/home/favorites/liked-songs"]},{name:"Subir m\xFAsica",icon:"uil-cloud-upload",router:["/home/tracks/admin"]}],this.customOptions=[{name:"Mi lista \xBA1",router:["/"]},{name:"Mi lista \xBA2",router:["/"]},{name:"Mi lista \xBA3",router:["/"]},{name:"Mi lista \xBA4",router:["/"]}]}static \u0275fac=function(t){return new(t||r)(y(X))};static \u0275cmp=O({type:r,selectors:[["app-side-bar"]],decls:11,vars:3,consts:[[1,"side-bar"],[1,"uil","uil-ellipsis-h"],[1,"side-bar__list","list-one"],[3,"routerLink",4,"ngFor","ngForOf"],[1,"side-bar__separator"],[1,"side-bar__list","list-two"],[1,"side-bar__separator","line-separator"],[1,"side-bar__list","list-three"],[4,"ngFor","ngForOf"],[3,"routerLink"],[1,"list-wrapper-item"],[3,"ngClass"],[1,"side-bar__list","list-label"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"div"),g(2,"i",1),a(),o(3,"ul",2),f(4,Ge,5,6,"li",3),a(),g(5,"div",4),o(6,"ul",5),f(7,Ke,5,6,"li",3),a(),g(8,"div",6),o(9,"ul",7),f(10,Ye,4,1,"li",8),a()()),t&2&&(l(4),c("ngForOf",n.mainMenu.defaultOptions),l(3),c("ngForOf",n.mainMenu.accessLink),l(3),c("ngForOf",n.customOptions))},dependencies:[P,I,R,J,$e],styles:['.side-bar[_ngcontent-%COMP%]{width:15.5rem;height:100vh;position:fixed;top:0;left:0;padding:.5rem .75rem;background-color:var(--color-5);overflow-x:hidden;overflow-y:auto;z-index:100;box-sizing:border-box}.side-bar__list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;opacity:.8}.side-bar__list[_ngcontent-%COMP%]   .list-label[_ngcontent-%COMP%]{font-size:90%;font-weight:500}.side-bar__list[_ngcontent-%COMP%]   .list-wrapper-item[_ngcontent-%COMP%]{font-size:var(--font-size-1);font-weight:500;display:flex;align-items:center;align-content:center}.side-bar__list[_ngcontent-%COMP%]   .list-wrapper-item[_ngcontent-%COMP%]   .uil[_ngcontent-%COMP%]{font-size:var(--font-size-3);padding-right:.5rem}.side-bar__separator[_ngcontent-%COMP%]{margin:1rem 0}.side-bar__separator.line-separator[_ngcontent-%COMP%]{border-bottom:solid 1px var(--color-2)}.side-bar__list.list-three[_ngcontent-%COMP%]   .list-wrapper-item[_ngcontent-%COMP%]{padding:.25rem 0}.side-bar__list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{cursor:pointer}@media (max-width: 1024px){.side-bar[_ngcontent-%COMP%]{width:14rem}.side-bar__list[_ngcontent-%COMP%]   .list-label[_ngcontent-%COMP%]{font-size:85%}.side-bar__list[_ngcontent-%COMP%]   .list-wrapper-item[_ngcontent-%COMP%]   .uil[_ngcontent-%COMP%]{font-size:1.2rem;padding-right:.4rem}}@media (max-width: 768px){.side-bar[_ngcontent-%COMP%]{width:12rem;padding:.4rem .8rem}.side-bar__list[_ngcontent-%COMP%]   .list-label[_ngcontent-%COMP%]{font-size:80%}.side-bar__list[_ngcontent-%COMP%]   .list-wrapper-item[_ngcontent-%COMP%]   .uil[_ngcontent-%COMP%]{font-size:1.1rem;padding-right:.3rem}.side-bar__separator[_ngcontent-%COMP%]{margin:.8rem 0}}@media (max-width: 480px){.side-bar[_ngcontent-%COMP%]{width:3.5rem;padding:.3rem .2rem;overflow-x:hidden}.side-bar__list[_ngcontent-%COMP%]   .list-label[_ngcontent-%COMP%]{display:none}.side-bar__list[_ngcontent-%COMP%]   .list-wrapper-item[_ngcontent-%COMP%]{justify-content:center;padding:.5rem 0;width:100%}.side-bar__list[_ngcontent-%COMP%]   .list-wrapper-item[_ngcontent-%COMP%]   .uil[_ngcontent-%COMP%]{font-size:1.3rem;padding-right:0;margin:0}.side-bar__separator[_ngcontent-%COMP%]{margin:.5rem 0}.side-bar__list.list-three[_ngcontent-%COMP%]   .list-wrapper-item[_ngcontent-%COMP%]{padding:.3rem 0}}@media (max-width: 360px){.side-bar[_ngcontent-%COMP%]{width:3rem;padding:.2rem .1rem}.side-bar__list[_ngcontent-%COMP%]   .list-wrapper-item[_ngcontent-%COMP%]   .uil[_ngcontent-%COMP%]{font-size:1.2rem}.side-bar__list[_ngcontent-%COMP%]   .list-wrapper-item[_ngcontent-%COMP%]{padding:.4rem 0}}@media (max-width: 480px){.side-bar__list[_ngcontent-%COMP%]   .list-wrapper-item[_ngcontent-%COMP%]{position:relative}.side-bar__list[_ngcontent-%COMP%]   .list-wrapper-item[_ngcontent-%COMP%]:hover:after{content:attr(data-tooltip);position:absolute;left:100%;top:50%;transform:translateY(-50%);background:var(--color-1);color:#fff;padding:.5rem .75rem;border-radius:6px;font-size:.75rem;white-space:nowrap;z-index:1000;margin-left:.5rem;box-shadow:0 4px 12px #0000004d}.side-bar__list[_ngcontent-%COMP%]   .list-wrapper-item[_ngcontent-%COMP%]:hover:before{content:"";position:absolute;left:calc(100% - 6px);top:50%;transform:translateY(-50%);width:0;height:0;border-top:6px solid transparent;border-bottom:6px solid transparent;border-right:6px solid var(--color-1);z-index:1000}}']})};var z=class r{currentTrack$=new M(null);isPlaying$=new M(!1);currentTime$=new M(0);duration$=new M(0);isLoading$=new M(!1);audio=new Audio;constructor(){this.audio.crossOrigin="anonymous",this.audio.preload="metadata",this.listenAudioEvents()}get currentTrack(){return this.currentTrack$.asObservable()}get isPlaying(){return this.isPlaying$.asObservable()}get currentTime(){return this.currentTime$.asObservable()}get duration(){return this.duration$.asObservable()}get isLoading(){return this.isLoading$.asObservable()}setTrack(e){console.log("\u{1F3B5} Setting new track:",e.name),console.log("\u{1F3B5} Track object:",e);let t=e.url;if(console.log("\u{1F517} Audio URL:",t),!t){console.error("\u274C No audio URL found in track:",e);return}if(!t.startsWith("http://")&&!t.startsWith("https://")){console.error("\u274C Invalid URL format:",t);return}this.currentTrack$.next(e),console.log("\u{1F4E1} Setting audio src to:",t),this.isLoading$.next(!0),this.audio.src=t,this.audio.load(),console.log("\u{1F504} Audio load() called")}play(){return j(this,null,function*(){try{yield this.audio.play(),this.isPlaying$.next(!0),console.log("\u2705 Audio playing successfully")}catch(e){if(console.error("\u274C Play failed:",e),this.isPlaying$.next(!1),e.name!=="AbortError")throw e}})}pause(){this.audio.pause(),this.isPlaying$.next(!1)}togglePlay(){if(!this.audio.src){console.warn("\u26A0\uFE0F No audio source set, cannot toggle play");return}this.isPlaying$.value?(console.log("\u23F8\uFE0F Pausing audio"),this.pause()):(console.log("\u25B6\uFE0F Playing audio"),this.play().catch(e=>{console.error("\u274C Toggle play failed:",e)}))}seekTo(e){this.audio&&!isNaN(e)&&e>=0&&e<=this.audio.duration?(console.log("\u{1F3AF} Seeking to time:",e,"seconds"),this.audio.currentTime=e):console.warn("\u26A0\uFE0F Invalid seek time:",e,"duration:",this.audio?.duration)}setVolume(e){let t=Math.max(0,Math.min(1,e/100));console.log("\u{1F50A} Setting volume to:",t),this.audio.volume=t}testAudioUrl(e){return j(this,null,function*(){try{console.log("\u{1F9EA} Testing audio URL:",e);let t=new Audio;return t.crossOrigin="anonymous",new Promise(n=>{t.addEventListener("canplay",()=>{console.log("\u2705 Test audio can play"),n(!0)}),t.addEventListener("error",i=>{console.error("\u274C Test audio error:",i),console.error("\u274C Test audio error details:",t.error),n(!1)}),t.src=e,t.load()})}catch(t){return console.error("\u274C Test audio exception:",t),!1}})}listenAudioEvents(){this.audio.addEventListener("loadedmetadata",()=>{console.log("\u{1F4CA} Audio metadata loaded, duration:",this.audio.duration),this.duration$.next(this.audio.duration||0),this.isLoading$.next(!1)}),this.audio.addEventListener("timeupdate",()=>{this.currentTime$.next(this.audio.currentTime)}),this.audio.addEventListener("ended",()=>{console.log("\u{1F51A} Audio ended"),this.isPlaying$.next(!1)}),this.audio.addEventListener("error",e=>{console.error("\u274C Audio error during playback:",e),console.error("\u274C Error details:",this.audio.error),console.error("\u274C Audio source:",this.audio.src),console.error("\u274C Audio network state:",this.audio.networkState),console.error("\u274C Audio ready state:",this.audio.readyState),this.isPlaying$.next(!1),this.isLoading$.next(!1)}),this.audio.addEventListener("canplay",()=>{console.log("\u2705 Audio can play"),this.isLoading$.next(!1)}),this.audio.addEventListener("loadstart",()=>{console.log("\u{1F4E5} Audio load started")}),this.audio.addEventListener("loadeddata",()=>{console.log("\u{1F4CA} Audio data loaded")}),this.audio.addEventListener("abort",()=>{console.log("\u{1F6AB} Audio load aborted")}),this.audio.addEventListener("stalled",()=>{console.log("\u23F3 Audio load stalled")})}static \u0275fac=function(t){return new(t||r)};static \u0275prov=L({token:r,factory:r.\u0275fac,providedIn:"root"})};var Qe=(r,e,t)=>({"uil-volume-off":r,"uil-volume-down":e,"uil-volume-up":t}),Xe=(r,e)=>({"uil-play":r,"uil-pause":e});function Je(r,e){if(r&1&&g(0,"i",29),r&2){let t=p();c("ngClass",E(1,Xe,!t.isPlaying,t.isPlaying))}}function Ze(r,e){r&1&&g(0,"div",31)}var te=class r{constructor(e){this.multimediaService=e}currentTrack=null;isPlaying=!1;currentTime=0;duration=0;progressPercentage=0;volume=50;isMuted=!1;isLoading=!1;hasError=!1;destroy$=new F;ngOnInit(){this.multimediaService.currentTrack.pipe(b(this.destroy$)).subscribe(e=>{console.log("\u{1F3B5} Current track changed:",e?.name),this.currentTrack=e,this.hasError=!1,this.isLoading=!!e}),this.multimediaService.isPlaying.pipe(b(this.destroy$)).subscribe(e=>{this.isPlaying=e}),this.multimediaService.currentTime.pipe(b(this.destroy$)).subscribe(e=>{this.currentTime=e,this.updateProgress()}),this.multimediaService.duration.pipe(b(this.destroy$)).subscribe(e=>{this.duration=e,this.updateProgress()}),this.multimediaService.isLoading.pipe(b(this.destroy$)).subscribe(e=>{this.isLoading=e})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}togglePlay(){this.multimediaService.togglePlay()}previousTrack(){console.log("\u23EE\uFE0F Previous track - TODO: implement")}nextTrack(){console.log("\u23ED\uFE0F Next track - TODO: implement")}skipForward(e=10){let t=Math.min(this.currentTime+e,this.duration);this.multimediaService.seekTo(t)}skipBackward(e=10){let t=Math.max(this.currentTime-e,0);this.multimediaService.seekTo(t)}goToTime(e,t=0){let n=e*60+t;n<=this.duration&&this.multimediaService.seekTo(n)}setVolume(e){let t=e.target.value;this.volume=t,this.multimediaService.setVolume(t),this.isMuted&&t>0&&(this.isMuted=!1)}toggleMute(){this.isMuted=!this.isMuted,this.multimediaService.setVolume(this.isMuted?0:this.volume)}seekTo(e){if(this.duration<=0){console.warn("\u26A0\uFE0F Cannot seek: duration not loaded");return}let n=e.currentTarget.getBoundingClientRect(),i=e.clientX-n.left,s=Math.max(0,Math.min(1,i/n.width)),_=s*this.duration;console.log("\u{1F3AF} Seeking to:",_,"seconds (",s*100,"%)"),this.multimediaService.seekTo(_)}updateProgress(){this.duration>0&&(this.progressPercentage=this.currentTime/this.duration*100)}formatTime(e){if(!e||isNaN(e))return"00:00";let t=Math.floor(e/60),n=Math.floor(e%60);return`${t.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`}onImageError(e){let t=e.target;t&&(t.src="https://i.pinimg.com/736x/69/d5/3e/69d53ef9520b57a5e2af1b1387807fc7.jpg")}handleKeyboardShortcut(e){if(e.target.tagName!=="INPUT")switch(e.code){case"Space":e.preventDefault(),this.togglePlay();break;case"ArrowLeft":e.preventDefault(),this.skipBackward(5);break;case"ArrowRight":e.preventDefault(),this.skipForward(5);break;case"ArrowUp":e.preventDefault(),this.adjustVolume(10);break;case"ArrowDown":e.preventDefault(),this.adjustVolume(-10);break;case"KeyM":e.preventDefault(),this.toggleMute();break}}adjustVolume(e){let t=Math.max(0,Math.min(100,this.volume+e));this.volume=t,this.multimediaService.setVolume(t),this.isMuted&&t>0&&(this.isMuted=!1)}get displayTrack(){return this.currentTrack||{cover_url:"https://i.scdn.co/image/ab67616d0000b27345ca41b0d2352242c7c9d4bc",album:"Selecciona una canci\xF3n",name:"No hay canci\xF3n seleccionada",artist:"Artista desconocido",_id:0}}static \u0275fac=function(t){return new(t||r)(y(z))};static \u0275cmp=O({type:r,selectors:[["app-media-player"]],hostBindings:function(t,n){t&1&&m("keydown",function(s){return n.handleKeyboardShortcut(s)},!1,Me)},decls:38,vars:19,consts:[[1,"media-player"],[1,"track-info"],[1,"cover",3,"error","src","alt"],[1,"track-details"],[1,"track-name"],[1,"track-artist"],[1,"player-controls"],[1,"control-buttons"],["title","Anterior",1,"control-btn",3,"click"],[1,"uil","uil-previous"],["title","Retroceder 10 segundos",1,"control-btn","skip-btn",3,"click"],[1,"uil","uil-step-backward"],[1,"skip-time"],["title","Reproducir/Pausar",1,"play-pause-btn",3,"click","disabled"],["class","uil",3,"ngClass",4,"ngIf"],["class","loading-spinner",4,"ngIf"],["title","Avanzar 10 segundos",1,"control-btn","skip-btn",3,"click"],[1,"uil","uil-step-forward"],["title","Siguiente",1,"control-btn",3,"click"],[1,"uil","uil-skip-forward"],[1,"progress-section"],[1,"time","current-time"],[1,"progress-bar-container"],["title","Hacer clic para saltar a una posici\xF3n",1,"progress-bar",3,"click"],[1,"progress-fill"],[1,"progress-handle"],[1,"time","total-time"],[1,"volume-controls"],["title","Silenciar",1,"volume-btn",3,"click"],[1,"uil",3,"ngClass"],["type","range","min","0","max","100","title","Volumen",1,"volume-slider",3,"input","value"],[1,"loading-spinner"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"div",1)(2,"img",2),m("error",function(s){return n.onImageError(s)}),a(),o(3,"div",3)(4,"div",4),d(5),a(),o(6,"div",5),d(7),a()()(),o(8,"div",6)(9,"div",7)(10,"button",8),m("click",function(){return n.previousTrack()}),g(11,"i",9),a(),o(12,"button",10),m("click",function(){return n.skipBackward(10)}),g(13,"i",11),o(14,"span",12),d(15,"10"),a()(),o(16,"button",13),m("click",function(){return n.togglePlay()}),f(17,Je,1,4,"i",14)(18,Ze,1,0,"div",15),a(),o(19,"button",16),m("click",function(){return n.skipForward(10)}),g(20,"i",17),o(21,"span",12),d(22,"10"),a()(),o(23,"button",18),m("click",function(){return n.nextTrack()}),g(24,"i",19),a()(),o(25,"div",20)(26,"span",21),d(27),a(),o(28,"div",22)(29,"div",23),m("click",function(s){return n.seekTo(s)}),g(30,"div",24)(31,"div",25),a()(),o(32,"span",26),d(33),a()()(),o(34,"div",27)(35,"button",28),m("click",function(){return n.toggleMute()}),g(36,"i",29),a(),o(37,"input",30),m("input",function(s){return n.setVolume(s)}),a()()()),t&2&&(l(2),c("src",n.displayTrack.cover_url,T)("alt",n.displayTrack.name),l(3),v(n.displayTrack.name),l(2),v(n.displayTrack.artist||"Artista desconocido"),l(9),c("disabled",n.isLoading),l(),c("ngIf",!n.isLoading),l(),c("ngIf",n.isLoading),l(9),v(n.formatTime(n.currentTime)),l(3),de("width",n.progressPercentage,"%"),l(),de("left",n.progressPercentage,"%"),l(2),v(n.formatTime(n.duration)),l(3),c("ngClass",Ie(15,Qe,n.isMuted||n.volume===0,!n.isMuted&&n.volume>0&&n.volume<=50,!n.isMuted&&n.volume>50)),l(),c("value",n.volume))},dependencies:[P,I,U],styles:[".media-player[_ngcontent-%COMP%]{background-color:var(--color-5);position:fixed;bottom:0;width:100%;z-index:2;height:90px;border-top:solid 1px var(--color-2);box-shadow:0 -15px 15px 7px #0000002e;display:flex;align-items:center;padding:0 1rem;gap:1rem}.track-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;min-width:250px;flex:1}.track-info[_ngcontent-%COMP%]   .cover[_ngcontent-%COMP%]{width:56px;height:56px;border-radius:var(--border-radius-1);object-fit:cover;background-color:var(--color-2)}.track-details[_ngcontent-%COMP%]{flex:1;min-width:0}.track-name[_ngcontent-%COMP%]{font-weight:500;font-size:.9rem;color:var(--color-4);margin:0 0 4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.track-artist[_ngcontent-%COMP%]{font-size:.8rem;color:#b3b3b3;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.player-controls[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;flex:2;max-width:600px;gap:.5rem}.control-buttons[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.control-btn[_ngcontent-%COMP%]{background:none;border:none;color:#b3b3b3;cursor:pointer;padding:8px;border-radius:50%;transition:all .2s ease;font-size:1.2rem;width:40px;height:40px;display:flex;align-items:center;justify-content:center}.control-btn[_ngcontent-%COMP%]:hover{color:var(--color-4);background-color:#ffffff1a}.play-pause-btn[_ngcontent-%COMP%]{background:var(--color-4);border:none;color:var(--color-3);cursor:pointer;width:48px;height:48px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.4rem;transition:all .2s ease;margin:0 .5rem}.play-pause-btn[_ngcontent-%COMP%]:hover{transform:scale(1.05);background:#fff}.skip-btn[_ngcontent-%COMP%]{position:relative}.skip-time[_ngcontent-%COMP%]{position:absolute;top:-20px;left:50%;transform:translate(-50%);font-size:.6rem;color:#b3b3b3;font-weight:500}.progress-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;width:100%}.time[_ngcontent-%COMP%]{font-size:.75rem;color:#b3b3b3;min-width:40px;text-align:center}.progress-bar-container[_ngcontent-%COMP%]{flex:1;height:12px;display:flex;align-items:center}.progress-bar[_ngcontent-%COMP%]{width:100%;height:4px;background-color:var(--color-2);border-radius:2px;position:relative;cursor:pointer;transition:all .2s ease}.progress-bar[_ngcontent-%COMP%]:hover{height:6px}.progress-fill[_ngcontent-%COMP%]{height:100%;background-color:var(--color-1);border-radius:2px;transition:width .1s ease}.progress-handle[_ngcontent-%COMP%]{position:absolute;top:50%;transform:translate(-50%,-50%);width:12px;height:12px;background-color:var(--color-4);border-radius:50%;opacity:0;transition:opacity .2s ease}.progress-bar[_ngcontent-%COMP%]:hover   .progress-handle[_ngcontent-%COMP%]{opacity:1}.volume-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;min-width:150px;flex:1;justify-content:flex-end}.volume-btn[_ngcontent-%COMP%]{background:none;border:none;color:#b3b3b3;cursor:pointer;padding:8px;border-radius:50%;transition:all .2s ease;font-size:1.1rem;width:32px;height:32px;display:flex;align-items:center;justify-content:center}.volume-btn[_ngcontent-%COMP%]:hover{color:var(--color-4);background-color:#ffffff1a}.volume-slider[_ngcontent-%COMP%]{width:80px;height:4px;background:var(--color-2);border-radius:2px;outline:none;cursor:pointer}.volume-slider[_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:12px;height:12px;background:var(--color-4);border-radius:50%;cursor:pointer}.volume-slider[_ngcontent-%COMP%]::-moz-range-thumb{width:12px;height:12px;background:var(--color-4);border-radius:50%;cursor:pointer;border:none}.loading-spinner[_ngcontent-%COMP%]{width:20px;height:20px;border:2px solid rgba(0,0,0,.3);border-top:2px solid var(--color-3);border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 1024px){.media-player[_ngcontent-%COMP%]{height:85px;padding:0 .75rem;gap:.75rem}.track-info[_ngcontent-%COMP%]{min-width:200px}.track-info[_ngcontent-%COMP%]   .cover[_ngcontent-%COMP%]{width:50px;height:50px}.track-name[_ngcontent-%COMP%]{font-size:.85rem}.track-artist[_ngcontent-%COMP%]{font-size:.75rem}.control-btn[_ngcontent-%COMP%]{width:36px;height:36px;font-size:1.1rem}.play-pause-btn[_ngcontent-%COMP%]{width:44px;height:44px;font-size:1.3rem}.volume-slider[_ngcontent-%COMP%]{width:70px}}@media (max-width: 768px){.media-player[_ngcontent-%COMP%]{height:80px;padding:0 .5rem;gap:.5rem;flex-wrap:nowrap}.track-info[_ngcontent-%COMP%]{min-width:140px;gap:.5rem}.track-info[_ngcontent-%COMP%]   .cover[_ngcontent-%COMP%]{width:45px;height:45px}.track-name[_ngcontent-%COMP%]{font-size:.8rem}.track-artist[_ngcontent-%COMP%]{font-size:.7rem}.player-controls[_ngcontent-%COMP%]{flex:1.5;gap:.25rem}.control-buttons[_ngcontent-%COMP%]{gap:.25rem}.control-btn[_ngcontent-%COMP%]{width:32px;height:32px;font-size:1rem;padding:6px}.play-pause-btn[_ngcontent-%COMP%]{width:40px;height:40px;font-size:1.2rem}.progress-container[_ngcontent-%COMP%]{gap:.5rem}.time-display[_ngcontent-%COMP%]{font-size:.7rem;min-width:35px}.volume-controls[_ngcontent-%COMP%]{min-width:80px;gap:.25rem}.volume-btn[_ngcontent-%COMP%]{width:28px;height:28px;font-size:1rem}.volume-slider[_ngcontent-%COMP%]{width:50px;height:3px}.skip-time[_ngcontent-%COMP%]{display:none}}@media (max-width: 480px){.media-player[_ngcontent-%COMP%]{height:70px;padding:0 .25rem;gap:.25rem}.track-info[_ngcontent-%COMP%]{min-width:100px;gap:.35rem}.track-info[_ngcontent-%COMP%]   .cover[_ngcontent-%COMP%]{width:40px;height:40px}.track-details[_ngcontent-%COMP%]{min-width:60px}.track-name[_ngcontent-%COMP%]{font-size:.75rem;margin-bottom:2px}.track-artist[_ngcontent-%COMP%]{font-size:.65rem}.player-controls[_ngcontent-%COMP%]{flex:1;gap:.1rem}.control-buttons[_ngcontent-%COMP%]{gap:.1rem}.control-btn[_ngcontent-%COMP%]{width:28px;height:28px;font-size:.9rem;padding:4px}.play-pause-btn[_ngcontent-%COMP%]{width:36px;height:36px;font-size:1.1rem}.progress-container[_ngcontent-%COMP%]{gap:.25rem}.time-display[_ngcontent-%COMP%]{font-size:.65rem;min-width:30px}.progress-bar[_ngcontent-%COMP%]{height:3px}.progress-bar[_ngcontent-%COMP%]::-webkit-slider-thumb{width:10px;height:10px}.volume-controls[_ngcontent-%COMP%]{min-width:60px;gap:.15rem}.volume-btn[_ngcontent-%COMP%]{width:26px;height:26px;font-size:.9rem}.volume-slider[_ngcontent-%COMP%]{width:35px;height:2px}.volume-slider[_ngcontent-%COMP%]::-webkit-slider-thumb{width:8px;height:8px}.skip-backward[_ngcontent-%COMP%], .skip-forward[_ngcontent-%COMP%]{display:none}}@media (max-width: 360px){.media-player[_ngcontent-%COMP%]{height:65px;padding:0 .15rem}.track-info[_ngcontent-%COMP%]{min-width:80px;gap:.25rem}.track-info[_ngcontent-%COMP%]   .cover[_ngcontent-%COMP%]{width:35px;height:35px}.track-name[_ngcontent-%COMP%]{font-size:.7rem}.track-artist[_ngcontent-%COMP%]{font-size:.6rem}.control-btn[_ngcontent-%COMP%]{width:26px;height:26px;font-size:.8rem}.play-pause-btn[_ngcontent-%COMP%]{width:32px;height:32px;font-size:1rem}.time-display[_ngcontent-%COMP%]{font-size:.6rem;min-width:25px}.volume-controls[_ngcontent-%COMP%]{min-width:50px}.volume-btn[_ngcontent-%COMP%]{width:24px;height:24px;font-size:.8rem}.volume-slider[_ngcontent-%COMP%]{width:25px}.shuffle-btn[_ngcontent-%COMP%], .repeat-btn[_ngcontent-%COMP%]{display:none}}@media (max-width: 768px) and (orientation: landscape){.media-player[_ngcontent-%COMP%]{height:60px}.track-info[_ngcontent-%COMP%]   .cover[_ngcontent-%COMP%]{width:35px;height:35px}.control-btn[_ngcontent-%COMP%]{width:30px;height:30px}.play-pause-btn[_ngcontent-%COMP%]{width:36px;height:36px}}"]})};var V=class r{constructor(e){this.http=e}API_URL="http://localhost:5000/api/music";tracksRefreshSubject=new M(!1);tracksRefresh$=this.tracksRefreshSubject.asObservable();getAllTracks(){return console.log("Calling API:",`${this.API_URL}/songs`),this.http.get(`${this.API_URL}/songs`).pipe(w(e=>{console.log("Raw API response:",e);let t=[];if(e&&e.data&&Array.isArray(e.data))console.log("Extracting data array:",e.data),t=e.data;else if(e&&e.songs&&Array.isArray(e.songs))console.log("Extracting songs array:",e.songs),t=e.songs;else if(Array.isArray(e))console.log("Response is already an array:",e),t=e;else return console.warn("API response is not an array, returning empty array:",e),[];let n=t.map(i=>{console.log("\u{1F504} Processing song:",i.title,"with file_path:",i.file_path);let s={_id:i.id||i._id||Math.random(),name:i.title||i.name||"T\xEDtulo desconocido",artist:i.artist||"Artista desconocido",album:i.album||"Album desconocido",cover_url:i.cover_url||i.image_url||i.cover||"assets/img/default-cover.png",url:i.file_path||i.url||"",duration:i.duration||0,created_at:i.created_at||new Date().toISOString(),explicit:i.explicit||!1};return console.log("\u2705 Transformed track:",s.name,"with URL:",s.url),s});return console.log("Transformed tracks:",n),n}))}getTrackById(e){return this.http.get(`${this.API_URL}/tracks/${e}`)}searchTracks(e){return this.http.get(`${this.API_URL}/search?q=${e}`)}searchTracksOnServer(e){console.log("\u{1F50D} Searching tracks on server with params:",e);let t=new URLSearchParams;if(e.query&&e.query.trim().length>=2&&t.append("q",e.query.trim()),e.title&&e.title.trim().length>=2&&t.append("title",e.title.trim()),e.artist&&e.artist.trim().length>=2&&t.append("artist",e.artist.trim()),t.toString()==="")return console.warn("\u26A0\uFE0F No valid search parameters provided"),new G(i=>{i.next([]),i.complete()});let n=`${this.API_URL}/songs/search?${t.toString()}`;return console.log("\u{1F310} Search URL:",n),this.http.get(n).pipe(w(i=>{console.log("\u{1F50D} Search API response:",i);let s=[];if(i&&i.data&&Array.isArray(i.data))s=i.data;else if(Array.isArray(i))s=i;else return console.warn("Search API response is not an array:",i),[];let _=s.map(C=>(console.log("\u{1F504} Processing search result:",C.title),{_id:C.id||C._id||Math.random(),name:C.title||C.name||"T\xEDtulo desconocido",artist:C.artist||"Artista desconocido",album:C.album||"Album desconocido",cover_url:C.cover_url||C.image_url||C.cover||"assets/img/default-cover.png",url:C.file_path||C.url||"",duration:C.duration||0,created_at:C.created_at||new Date().toISOString(),explicit:C.explicit||!1}));return console.log("\u2705 Search results transformed:",_.length,"tracks"),_}))}refreshTracks(){console.log("\u{1F504} TracksService: Triggering tracks refresh"),this.tracksRefreshSubject.next(!0)}static \u0275fac=function(t){return new(t||r)(A($))};static \u0275prov=L({token:r,factory:r.\u0275fac,providedIn:"root"})};var et=["searchInput"];function tt(r,e){r&1&&g(0,"i",10)}function nt(r,e){r&1&&g(0,"div",11)}function it(r,e){if(r&1){let t=x();o(0,"button",12),m("click",function(){u(t);let i=p();return h(i.clearSearch())}),g(1,"i",13),a()}}function rt(r,e){if(r&1){let t=x();o(0,"div",21),m("click",function(i){let s=u(t).$implicit;return p(2).playTrack(s),h(i.stopPropagation())}),o(1,"div",22)(2,"img",23),m("error",function(i){u(t);let s=p(2);return h(s.onImageError(i))}),a(),o(3,"div",24),g(4,"i",25),a()(),o(5,"div",26)(6,"div",27),d(7),a(),o(8,"div",28),d(9),a()(),o(10,"div",29),d(11),a()()}if(r&2){let t=e.$implicit;l(2),c("src",t.cover_url,T)("alt",t.name),l(5),v(t.name),l(2),v(t.artist),l(2),k(" ",t.duration,"s ")}}function ot(r,e){r&1&&(o(0,"div",30),g(1,"i",10),o(2,"span"),d(3,"No se encontraron resultados"),a()())}function at(r,e){r&1&&(o(0,"div",31),g(1,"div",32),o(2,"span"),d(3,"Buscando..."),a()())}function st(r,e){if(r&1){let t=x();o(0,"div",14),m("click",function(i){return u(t),h(i.stopPropagation())}),o(1,"div",15)(2,"span"),d(3),a(),o(4,"button",16),m("click",function(){u(t);let i=p();return h(i.goToSearch())}),d(5," Ver todos "),a()(),o(6,"div",17),f(7,rt,12,5,"div",18),Y(8,"slice"),f(9,ot,4,0,"div",19)(10,at,4,0,"div",20),a()()}if(r&2){let t=p();l(3),k("Resultados de b\xFAsqueda (",t.searchResults.length,")"),l(4),c("ngForOf",Q(8,4,t.searchResults,0,5)),l(2),c("ngIf",t.searchResults.length===0&&!t.isSearching),l(),c("ngIf",t.isSearching)}}var ne=class r{constructor(e,t,n){this.router=e;this.tracksService=t;this.multimediaService=n}searchInput;searchResults=[];isSearching=!1;showSearchResults=!1;searchTerms=new F;subscriptions=[];ngOnInit(){this.setupSearch(),this.setupRouterListener(),this.setupGlobalClickListener()}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe()),this.searchTerms.complete()}setupRouterListener(){let e=this.router.events.pipe(ve(t=>t instanceof Ue)).subscribe(()=>{console.log("\u{1F310} Route changed, hiding search results"),this.showSearchResults=!1,this.searchResults=[],this.isSearching=!1,this.searchInput&&this.searchInput.nativeElement.blur()});this.subscriptions.push(e)}setupSearch(){let e=this.searchTerms.pipe(ye(300),Ce(),xe(t=>t.trim().length<2?(this.showSearchResults=!1,[]):(this.isSearching=!0,this.tracksService.searchTracksOnServer({query:t})))).subscribe({next:t=>{this.searchResults=t,this.showSearchResults=t.length>0,this.isSearching=!1,console.log("\u{1F50D} Search completed. Results:",t.length)},error:t=>{console.error("\u274C Search error:",t),this.searchResults=[],this.showSearchResults=!1,this.isSearching=!1}});this.subscriptions.push(e)}onSearchChange(e){let n=e.target.value;console.log("\u{1F50D} Search term changed:",n),this.searchTerms.next(n)}playTrack(e){console.log("\u25B6\uFE0F Playing track from search:",e.name),this.multimediaService.setTrack(e),this.hideSearchResultsImmediate()}hideSearchResults(){setTimeout(()=>{this.showSearchResults=!1},200)}hideSearchResultsImmediate(){this.showSearchResults=!1,this.searchResults=[],this.isSearching=!1}showResults(){this.searchResults.length>0&&(this.showSearchResults=!0)}goToSearch(){let e=this.searchInput.nativeElement.value;e.trim()&&(this.router.navigate(["/tracks"],{queryParams:{search:e.trim()}}),this.hideSearchResultsImmediate())}onSearchKeyDown(e){e.key==="Enter"?this.goToSearch():e.key==="Escape"&&(this.hideSearchResultsImmediate(),this.searchInput.nativeElement.blur())}clearSearch(){this.searchInput.nativeElement.value="",this.searchResults=[],this.showSearchResults=!1,this.isSearching=!1}setupGlobalClickListener(){let e=fe(document,"click").subscribe(t=>{!t.target.closest(".search-container")&&this.showSearchResults&&(console.log("\u{1F310} Click outside search, hiding results"),this.hideSearchResultsImmediate())});this.subscriptions.push(e)}onImageError(e){let t=e.target;t.src="assets/img/default-cover.png"}static \u0275fac=function(t){return new(t||r)(y(X),y(V),y(z))};static \u0275cmp=O({type:r,selectors:[["app-header-user"]],viewQuery:function(t,n){if(t&1&&Se(et,5),t&2){let i;Te(i=Ee())&&(n.searchInput=i.first)}},decls:10,vars:4,consts:[["searchInput",""],[1,"header-user"],[1,"search-container"],[1,"search-wrapper"],["type","text","placeholder","Buscar canciones, artistas...","autocomplete","off",1,"search-input",3,"input","focus","blur","keydown"],[1,"search-button",3,"click"],["class","uil uil-search",4,"ngIf"],["class","search-spinner",4,"ngIf"],["class","clear-search",3,"click",4,"ngIf"],["class","search-results",3,"click",4,"ngIf"],[1,"uil","uil-search"],[1,"search-spinner"],[1,"clear-search",3,"click"],[1,"uil","uil-times"],[1,"search-results",3,"click"],[1,"search-results-header"],[1,"view-all-button",3,"click"],[1,"search-results-list"],["class","search-result-item",3,"click",4,"ngFor","ngForOf"],["class","no-results",4,"ngIf"],["class","search-loading",4,"ngIf"],[1,"search-result-item",3,"click"],[1,"result-cover"],[3,"error","src","alt"],[1,"play-overlay"],[1,"uil","uil-play"],[1,"result-info"],[1,"result-title"],[1,"result-artist"],[1,"result-duration"],[1,"no-results"],[1,"search-loading"],[1,"loading-spinner"]],template:function(t,n){if(t&1){let i=x();o(0,"div",1)(1,"div",2)(2,"div",3)(3,"input",4,0),m("input",function(_){return u(i),h(n.onSearchChange(_))})("focus",function(){return u(i),h(n.showResults())})("blur",function(){return u(i),h(n.hideSearchResults())})("keydown",function(_){return u(i),h(n.onSearchKeyDown(_))}),a(),o(5,"button",5),m("click",function(){return u(i),h(n.goToSearch())}),f(6,tt,1,0,"i",6)(7,nt,1,0,"div",7),a(),f(8,it,2,0,"button",8),a(),f(9,st,11,8,"div",9),a()()}if(t&2){let i=K(4);l(6),c("ngIf",!n.isSearching),l(),c("ngIf",n.isSearching),l(),c("ngIf",i.value),l(),c("ngIf",n.showSearchResults)}},dependencies:[P,R,U,Le],styles:[".header-user[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:.75rem 1rem;width:100%}.search-container[_ngcontent-%COMP%]{position:relative;width:400px;max-width:100%}.search-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;background:var(--color-2);border-radius:50px;padding:8px 15px;border:2px solid transparent;transition:all .3s ease}.search-wrapper[_ngcontent-%COMP%]:focus-within{border-color:var(--color-4);box-shadow:0 0 0 3px #1db9541a}.search-input[_ngcontent-%COMP%]{flex:1;background:transparent;border:none;outline:none;color:var(--color-1);font-size:14px;padding:0}.search-input[_ngcontent-%COMP%]::placeholder{color:var(--color-3)}.search-button[_ngcontent-%COMP%]{background:transparent;border:none;color:var(--color-3);cursor:pointer;padding:5px;margin-left:10px;border-radius:50%;transition:all .3s ease}.search-button[_ngcontent-%COMP%]:hover{color:var(--color-4);background:#1db9541a}.clear-search[_ngcontent-%COMP%]{background:transparent;border:none;color:var(--color-3);cursor:pointer;padding:5px;margin-left:5px;border-radius:50%;transition:all .3s ease}.clear-search[_ngcontent-%COMP%]:hover{color:var(--color-1);background:#ffffff1a}.search-spinner[_ngcontent-%COMP%]{width:16px;height:16px;border:2px solid var(--color-3);border-top:2px solid var(--color-4);border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.search-results[_ngcontent-%COMP%]{position:absolute;top:calc(100% + 10px);left:0;right:0;background:var(--color-2);border-radius:12px;box-shadow:0 10px 30px #0000004d;z-index:1000;overflow:hidden;max-height:400px;border:1px solid rgba(255,255,255,.1)}.search-results-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 15px;background:#1db9541a;border-bottom:1px solid rgba(255,255,255,.1);font-size:12px;color:var(--color-3)}.view-all-button[_ngcontent-%COMP%]{background:transparent;border:none;color:var(--color-4);cursor:pointer;font-size:12px;text-decoration:underline}.search-results-list[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto}.search-result-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px 15px;cursor:pointer;transition:all .3s ease;border-bottom:1px solid rgba(255,255,255,.05)}.search-result-item[_ngcontent-%COMP%]:hover{background:#1db9541a}.search-result-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.result-cover[_ngcontent-%COMP%]{position:relative;width:40px;height:40px;margin-right:12px;border-radius:6px;overflow:hidden}.result-cover[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.play-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#000000b3;display:flex;align-items:center;justify-content:center;opacity:0;transition:all .3s ease}.search-result-item[_ngcontent-%COMP%]:hover   .play-overlay[_ngcontent-%COMP%]{opacity:1}.play-overlay[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff;font-size:14px}.result-info[_ngcontent-%COMP%]{flex:1;min-width:0}.result-title[_ngcontent-%COMP%]{font-size:14px;color:var(--color-1);margin-bottom:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.result-artist[_ngcontent-%COMP%]{font-size:12px;color:var(--color-3);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.result-duration[_ngcontent-%COMP%]{font-size:12px;color:var(--color-3);margin-left:10px}.no-results[_ngcontent-%COMP%], .search-loading[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:30px 15px;color:var(--color-3);font-size:14px}.no-results[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .search-loading[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:8px;font-size:18px}.loading-spinner[_ngcontent-%COMP%]{width:16px;height:16px;border:2px solid var(--color-3);border-top:2px solid var(--color-4);border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-right:8px}@media (max-width: 1024px){.search-container[_ngcontent-%COMP%]{width:350px}.search-wrapper[_ngcontent-%COMP%]{padding:10px 15px}.search-input[_ngcontent-%COMP%]{font-size:14px}}@media (max-width: 768px){.header-user[_ngcontent-%COMP%]{padding:.75rem}.search-container[_ngcontent-%COMP%]{width:100%;max-width:320px}.search-wrapper[_ngcontent-%COMP%]{padding:8px 12px}.search-input[_ngcontent-%COMP%]{font-size:13px}.search-results[_ngcontent-%COMP%]{left:-5px;right:-5px;max-height:350px}.search-results-list[_ngcontent-%COMP%]{max-height:250px}.result-cover[_ngcontent-%COMP%]{width:35px;height:35px;margin-right:10px}.result-title[_ngcontent-%COMP%]{font-size:13px}.result-artist[_ngcontent-%COMP%], .result-duration[_ngcontent-%COMP%]{font-size:11px}}@media (max-width: 480px){.header-user[_ngcontent-%COMP%]{padding:.5rem}.search-container[_ngcontent-%COMP%]{width:100%;max-width:280px}.search-wrapper[_ngcontent-%COMP%]{padding:6px 10px;border-radius:25px}.search-input[_ngcontent-%COMP%]{font-size:12px}.search-button[_ngcontent-%COMP%], .clear-search[_ngcontent-%COMP%]{padding:3px;margin-left:5px}.search-results[_ngcontent-%COMP%]{left:-10px;right:-10px;max-height:300px;border-radius:8px}.search-results-header[_ngcontent-%COMP%]{padding:8px 12px;font-size:11px}.search-results-list[_ngcontent-%COMP%]{max-height:200px}.search-result-item[_ngcontent-%COMP%]{padding:8px 12px}.result-cover[_ngcontent-%COMP%]{width:32px;height:32px;margin-right:8px;border-radius:4px}.result-info[_ngcontent-%COMP%]{margin-right:5px}.result-title[_ngcontent-%COMP%]{font-size:12px;margin-bottom:1px}.result-artist[_ngcontent-%COMP%]{font-size:10px}.result-duration[_ngcontent-%COMP%]{font-size:10px;margin-left:5px}.play-overlay[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:12px}.no-results[_ngcontent-%COMP%], .search-loading[_ngcontent-%COMP%]{padding:20px 12px;font-size:12px}.no-results[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .search-loading[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px;margin-right:6px}}@media (max-width: 360px){.header-user[_ngcontent-%COMP%]{padding:.25rem}.search-container[_ngcontent-%COMP%]{max-width:250px}.search-wrapper[_ngcontent-%COMP%]{padding:5px 8px}.search-input[_ngcontent-%COMP%]{font-size:11px}.search-results[_ngcontent-%COMP%]{left:-15px;right:-15px;max-height:250px}.search-results-list[_ngcontent-%COMP%]{max-height:150px}.search-result-item[_ngcontent-%COMP%]{padding:6px 10px}.result-cover[_ngcontent-%COMP%]{width:28px;height:28px;margin-right:6px}.result-title[_ngcontent-%COMP%]{font-size:11px}.result-artist[_ngcontent-%COMP%], .result-duration[_ngcontent-%COMP%]{font-size:9px}.search-results-header[_ngcontent-%COMP%]{padding:6px 10px;font-size:10px}.view-all-button[_ngcontent-%COMP%]{font-size:10px}}"]})};var Ne=(r,e)=>({"uil-play":r,"uil-pause":e});function lt(r,e){if(r&1){let t=x();o(0,"div",2)(1,"img",3),m("error",function(i){u(t);let s=p();return h(s.onImageError(i))}),a(),o(2,"div",4),d(3),a(),o(4,"div",5)(5,"button",6),m("click",function(){u(t);let i=p();return h(i.togglePlay())}),g(6,"i",7),a()()()}if(r&2){let t=p();l(),c("src",t.track.cover_url,T)("alt",t.track.name),l(2),k(" ",t.track.name," "),l(3),c("ngClass",E(4,Ne,!t.isPlaying,t.isPlaying))}}function ct(r,e){if(r&1){let t=x();o(0,"div",8)(1,"img",3),m("error",function(i){u(t);let s=p();return h(s.onImageError(i))}),a(),o(2,"div",4)(3,"div",9),d(4),a(),o(5,"div",10),d(6),a()(),o(7,"div",5)(8,"button",6),m("click",function(){u(t);let i=p();return h(i.togglePlay())}),g(9,"i",7),a()()()}if(r&2){let t=p();l(),c("src",t.track.cover_url,T)("alt",t.track.name),l(3),v(t.track.name),l(2),v(t.track.artist),l(3),c("ngClass",E(5,Ne,!t.isPlaying,t.isPlaying))}}var B=class r{constructor(e){this.multimediaService=e}mode="small";track;isPlaying=!1;currentTrack=null;destroy$=new F;ngOnInit(){this.multimediaService.currentTrack.pipe(b(this.destroy$)).subscribe(e=>{this.currentTrack=e}),this.multimediaService.isPlaying.pipe(b(this.destroy$)).subscribe(e=>{this.isCurrentTrack()?this.isPlaying=e:this.isPlaying=!1})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}isCurrentTrack(){return this.currentTrack?._id===this.track._id}togglePlay(){return j(this,null,function*(){try{this.isCurrentTrack()&&this.isPlaying?this.multimediaService.pause():(console.log("\u{1F3B5} Playing track from card:",this.track.name),this.multimediaService.setTrack(this.track),yield this.multimediaService.play())}catch(e){console.error("\u274C Failed to toggle play:",e)}})}onImageError(e){let t=e.target;t&&(t.src="https://i.pinimg.com/736x/69/d5/3e/69d53ef9520b57a5e2af1b1387807fc7.jpg")}static \u0275fac=function(t){return new(t||r)(y(z))};static \u0275cmp=O({type:r,selectors:[["app-card-player"]],inputs:{mode:"mode",track:"track"},decls:2,vars:2,consts:[["class","card-player player-small",4,"ngIf"],["class","card-player player-big",4,"ngIf"],[1,"card-player","player-small"],[1,"cover",3,"error","src","alt"],[1,"content-player"],[1,"buttons-player"],[1,"play-btn",3,"click"],[1,"uil",3,"ngClass"],[1,"card-player","player-big"],[1,"title-track"],[1,"sub-title-track"]],template:function(t,n){t&1&&f(0,lt,7,7,"div",0)(1,ct,10,8,"div",1),t&2&&(c("ngIf",n.mode==="small"),l(),c("ngIf",n.mode==="big"))},dependencies:[P,I,U],styles:[".card-player[_ngcontent-%COMP%]{background-color:var(--color-2);height:5rem;border-radius:var(--border-radius-1);display:flex;cursor:pointer;transition:all ease var(--animation-1);justify-content:space-between}.card-player[_ngcontent-%COMP%]:hover{background-color:#4d4d4d}.card-player[_ngcontent-%COMP%]   .cover[_ngcontent-%COMP%]{width:5rem;height:100%;object-fit:cover;border-top-left-radius:var(--border-radius-1);border-bottom-left-radius:var(--border-radius-1)}.card-player[_ngcontent-%COMP%]   .content-player[_ngcontent-%COMP%]{font-weight:500;display:flex;align-items:center;align-content:center;padding:0 0 0 .75rem}.card-player[_ngcontent-%COMP%]   .buttons-player[_ngcontent-%COMP%]{opacity:0;width:5rem;display:flex;justify-content:center;align-content:center;align-items:center;transition:all ease var(--animation-1)}.card-player[_ngcontent-%COMP%]:hover   .buttons-player[_ngcontent-%COMP%]{opacity:1}.card-player[_ngcontent-%COMP%]   .buttons-player[_ngcontent-%COMP%]   .play-btn[_ngcontent-%COMP%]{color:var(--color-4);border:0;font-size:1.15rem;border-radius:2rem;background-color:var(--color-1);width:45px;height:45px}.card-player.player-big[_ngcontent-%COMP%]{position:relative;flex-direction:column;height:18rem;padding:1rem}.card-player.player-big[_ngcontent-%COMP%]   .cover[_ngcontent-%COMP%]{width:100%;height:200px;border-radius:var(--border-radius-1)}.card-player.player-big[_ngcontent-%COMP%]   .content-player[_ngcontent-%COMP%]{padding:.5rem 0;flex-direction:column;align-self:flex-start;align-items:flex-start}.card-player.player-big[_ngcontent-%COMP%]   .content-player[_ngcontent-%COMP%]   .sub-title-track[_ngcontent-%COMP%]{font-size:80%;opacity:.7}.card-player.player-big[_ngcontent-%COMP%]   .buttons-player[_ngcontent-%COMP%]{position:absolute;right:0;top:13rem}@media (max-width: 1024px){.card-player[_ngcontent-%COMP%]{height:4.5rem}.card-player[_ngcontent-%COMP%]   .cover[_ngcontent-%COMP%]{width:4.5rem}.card-player[_ngcontent-%COMP%]   .content-player[_ngcontent-%COMP%]{padding:0 0 0 .6rem;font-size:.9rem}.card-player[_ngcontent-%COMP%]   .buttons-player[_ngcontent-%COMP%]{width:4.5rem}.card-player[_ngcontent-%COMP%]   .buttons-player[_ngcontent-%COMP%]   .play-btn[_ngcontent-%COMP%]{width:40px;height:40px;font-size:1rem}.card-player.player-big[_ngcontent-%COMP%]{height:16rem;padding:.8rem}.card-player.player-big[_ngcontent-%COMP%]   .cover[_ngcontent-%COMP%]{height:180px}.card-player.player-big[_ngcontent-%COMP%]   .buttons-player[_ngcontent-%COMP%]{top:11.5rem}}@media (max-width: 768px){.card-player[_ngcontent-%COMP%]{height:4rem;border-radius:6px}.card-player[_ngcontent-%COMP%]   .cover[_ngcontent-%COMP%]{width:4rem}.card-player[_ngcontent-%COMP%]   .content-player[_ngcontent-%COMP%]{padding:0 0 0 .5rem;font-size:.85rem}.card-player[_ngcontent-%COMP%]   .buttons-player[_ngcontent-%COMP%]{width:4rem}.card-player[_ngcontent-%COMP%]   .buttons-player[_ngcontent-%COMP%]   .play-btn[_ngcontent-%COMP%]{width:36px;height:36px;font-size:.9rem}.card-player.player-big[_ngcontent-%COMP%]{height:14rem;padding:.6rem}.card-player.player-big[_ngcontent-%COMP%]   .cover[_ngcontent-%COMP%]{height:160px}.card-player.player-big[_ngcontent-%COMP%]   .content-player[_ngcontent-%COMP%]{padding:.4rem 0}.card-player.player-big[_ngcontent-%COMP%]   .buttons-player[_ngcontent-%COMP%]{top:10rem}}@media (max-width: 480px){.card-player[_ngcontent-%COMP%]{height:3.5rem;border-radius:4px}.card-player[_ngcontent-%COMP%]   .cover[_ngcontent-%COMP%]{width:3.5rem}.card-player[_ngcontent-%COMP%]   .content-player[_ngcontent-%COMP%]{padding:0 0 0 .4rem;font-size:.8rem}.card-player[_ngcontent-%COMP%]   .buttons-player[_ngcontent-%COMP%]{width:3.5rem}.card-player[_ngcontent-%COMP%]   .buttons-player[_ngcontent-%COMP%]   .play-btn[_ngcontent-%COMP%]{width:32px;height:32px;font-size:.8rem}.card-player.player-big[_ngcontent-%COMP%]{height:12rem;padding:.5rem}.card-player.player-big[_ngcontent-%COMP%]   .cover[_ngcontent-%COMP%]{height:140px}.card-player.player-big[_ngcontent-%COMP%]   .content-player[_ngcontent-%COMP%]{padding:.3rem 0;font-size:.8rem}.card-player.player-big[_ngcontent-%COMP%]   .content-player[_ngcontent-%COMP%]   .sub-title-track[_ngcontent-%COMP%]{font-size:75%}.card-player.player-big[_ngcontent-%COMP%]   .buttons-player[_ngcontent-%COMP%]{top:8.5rem}}@media (max-width: 360px){.card-player[_ngcontent-%COMP%]{height:3rem}.card-player[_ngcontent-%COMP%]   .cover[_ngcontent-%COMP%]{width:3rem}.card-player[_ngcontent-%COMP%]   .content-player[_ngcontent-%COMP%]{padding:0 0 0 .3rem;font-size:.75rem}.card-player[_ngcontent-%COMP%]   .buttons-player[_ngcontent-%COMP%]{width:3rem}.card-player[_ngcontent-%COMP%]   .buttons-player[_ngcontent-%COMP%]   .play-btn[_ngcontent-%COMP%]{width:28px;height:28px;font-size:.7rem}.card-player.player-big[_ngcontent-%COMP%]{height:10rem;padding:.4rem}.card-player.player-big[_ngcontent-%COMP%]   .cover[_ngcontent-%COMP%]{height:120px}.card-player.player-big[_ngcontent-%COMP%]   .buttons-player[_ngcontent-%COMP%]{top:7rem}.card-player.player-big[_ngcontent-%COMP%]   .buttons-player[_ngcontent-%COMP%]   .play-btn[_ngcontent-%COMP%]{width:35px;height:35px;font-size:.9rem}}"]})};var dt=(r,e)=>({"card-small":r,"card-big":e});function pt(r,e){if(r&1&&(o(0,"li"),g(1,"app-card-player",5),a()),r&2){let t=e.$implicit,n=p();l(),c("track",t)("mode",n.mode)}}var ie=class r{title="";mode="big";dataTracks=[];constructor(){}ngOnInit(){}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=O({type:r,selectors:[["app-section-generic"]],inputs:{title:"title",mode:"mode",dataTracks:"dataTracks"},decls:6,vars:6,consts:[[1,"section--generic"],[1,"section--generic__title"],[1,"section--generic__player--zone"],[1,"player--list",3,"ngClass"],[4,"ngFor","ngForOf"],[3,"track","mode"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"h1",1),d(2),a(),o(3,"div",2)(4,"ul",3),f(5,pt,2,2,"li",4),a()()()),t&2&&(l(2),v(n.title),l(2),c("ngClass",E(3,dt,n.mode==="small",n.mode==="big")),l(),c("ngForOf",n.dataTracks))},dependencies:[P,I,R,B],styles:[".section--generic[_ngcontent-%COMP%]{margin-bottom:2rem;overflow-x:hidden;width:100%;box-sizing:border-box}.section--generic__player--zone[_ngcontent-%COMP%]   .player--list[_ngcontent-%COMP%]{display:grid;list-style:none;margin:0;padding:0;gap:1.15rem;width:100%;box-sizing:border-box}.section--generic__player--zone[_ngcontent-%COMP%]   .player--list.card-small[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(200px,1fr))}.section--generic__player--zone[_ngcontent-%COMP%]   .player--list.card-big[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(150px,1fr))}@media (max-width: 1024px){.section--generic__player--zone[_ngcontent-%COMP%]   .player--list.card-small[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:1rem}.section--generic__player--zone[_ngcontent-%COMP%]   .player--list.card-big[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:1rem}}@media (max-width: 768px){.section--generic__player--zone[_ngcontent-%COMP%]   .player--list.card-small[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:.8rem}.section--generic__player--zone[_ngcontent-%COMP%]   .player--list.card-big[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(130px,1fr));gap:.8rem}}@media (max-width: 480px){.section--generic[_ngcontent-%COMP%]{margin-bottom:1.5rem}.section--generic__player--zone[_ngcontent-%COMP%]   .player--list.card-small[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:.6rem}.section--generic__player--zone[_ngcontent-%COMP%]   .player--list.card-big[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:.6rem}}@media (max-width: 360px){.section--generic__player--zone[_ngcontent-%COMP%]   .player--list.card-small[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:.5rem}.section--generic__player--zone[_ngcontent-%COMP%]   .player--list.card-big[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:.5rem}}"]})};var re=class r{transform(e,t=null,n="asc"){try{if(t==null)return e;{let i=e.sort((s,_)=>s[t]<_[t]?-1:s[t]==_[t]?0:(s[t]>_[t],1));return n=="asc"?i:i.reverse()}}catch{return console.log("Algo paso"),e}}static \u0275fac=function(t){return new(t||r)};static \u0275pipe=ke({name:"orderlist",type:r,pure:!0})};var oe=class r{constructor(e){this.http=e;this.loadUserFavorites()}API_URL="http://localhost:5000/api/favorites";USER_ID=1;userFavorites$=new M([]);getUserFavorites(){return this.userFavorites$.asObservable()}loadUserFavorites(){this.http.get(`${this.API_URL}/user/${this.USER_ID}`).pipe(w(e=>(console.log("\u{1F525} Favorites API response:",e),e&&e.data&&Array.isArray(e.data)?e.data.map(t=>t.song_id):e&&Array.isArray(e)?e.map(t=>t.song_id):[]))).subscribe({next:e=>{console.log("\u{1F525} Loaded user favorites:",e),this.userFavorites$.next(e)},error:e=>{console.error("\u274C Error loading favorites:",e),this.userFavorites$.next([])}})}isFavorite(e){return this.userFavorites$.pipe(w(t=>t.includes(e)))}addToFavorites(e){return console.log("\u2795 Adding song to favorites:",e,"for user:",this.USER_ID),this.http.post(`${this.API_URL}/user/${this.USER_ID}/song/${e}`,{}).pipe(le(t=>{if(t.success){let n=this.userFavorites$.value;n.includes(e)||(this.userFavorites$.next([...n,e]),console.log("\u2705 Added to favorites locally"))}}))}removeFromFavorites(e){return console.log("\u2796 Removing song from favorites:",e,"for user:",this.USER_ID),this.http.delete(`${this.API_URL}/user/${this.USER_ID}/song/${e}`).pipe(le(t=>{if(t.success){let n=this.userFavorites$.value;this.userFavorites$.next(n.filter(i=>i!==e)),console.log("\u2705 Removed from favorites locally")}}))}toggleFavorite(e){return this.userFavorites$.value.includes(e)?this.removeFromFavorites(e).pipe(w(i=>!1)):this.addToFavorites(e).pipe(w(i=>!0))}checkFavoriteStatus(e){return this.http.get(`${this.API_URL}/user/${this.USER_ID}/song/${e}/check`).pipe(w(t=>t&&t.data&&t.data.is_favorite===!0))}static \u0275fac=function(t){return new(t||r)(A($))};static \u0275prov=L({token:r,factory:r.\u0275fac,providedIn:"root"})};var ae=class r{constructor(e){this.http=e}API_URL="http://localhost:5000/api/music";uploadProgress$=new M(null);isUploading$=new M(!1);getUploadProgress(){return this.uploadProgress$.asObservable()}getIsUploading(){return this.isUploading$.asObservable()}validateAudioFile(e){return["audio/mpeg","audio/mp3","audio/wav","audio/ogg","audio/m4a","audio/aac"].includes(e.type)?e.size>52428800?{valid:!1,error:"El archivo es demasiado grande. M\xE1ximo 50MB."}:{valid:!0}:{valid:!1,error:"Formato de archivo no soportado. Use MP3, WAV, OGG, M4A o AAC."}}uploadSong(e){let t=this.validateAudioFile(e.file);if(!t.valid)return new G(s=>{s.error({success:!1,message:t.error,error_code:"INVALID_FILE"})});let n=new FormData;n.append("file",e.file),n.append("title",e.title),n.append("artist",e.artist),e.album&&n.append("album",e.album),e.duration&&n.append("duration",e.duration.toString()),n.append("artist_name",e.artist_name||e.artist),e.artist_nickname&&n.append("artist_nickname",e.artist_nickname),e.nationality&&n.append("nationality",e.nationality),e.cover_url&&n.append("cover_url",e.cover_url),console.log("\u{1F4E4} Uploading song:",e.title,"by",e.artist);let i=new Re("POST",`${this.API_URL}/songs/upload`,n,{reportProgress:!0});return this.isUploading$.next(!0),this.uploadProgress$.next({percentage:0,status:"uploading",message:"Iniciando subida..."}),this.http.request(i).pipe(w(s=>{switch(s.type){case ge.UploadProgress:if(s.total){let _=Math.round(100*s.loaded/s.total);this.uploadProgress$.next({percentage:_,status:"uploading",message:`Subiendo archivo... ${_}%`})}return null;case ge.Response:if(this.isUploading$.next(!1),s.body?.success)return this.uploadProgress$.next({percentage:100,status:"completed",message:"Canci\xF3n subida exitosamente"}),console.log("\u2705 Upload completed:",s.body),s.body;throw this.uploadProgress$.next({percentage:0,status:"error",message:s.body?.message||"Error al subir la canci\xF3n"}),s.body;default:return null}}),be(s=>{throw console.error("\u274C Upload error:",s),this.isUploading$.next(!1),this.uploadProgress$.next({percentage:0,status:"error",message:s.message||"Error al subir la canci\xF3n"}),s}))}updateSong(e,t){let n=new FormData;return t.title&&n.append("title",t.title),t.artist&&n.append("artist",t.artist),t.album&&n.append("album",t.album),t.duration&&n.append("duration",t.duration.toString()),t.file&&n.append("file",t.file),t.artist_name&&n.append("artist_name",t.artist_name),t.artist_nickname&&n.append("artist_nickname",t.artist_nickname),t.nationality&&n.append("nationality",t.nationality),t.cover_url&&n.append("cover_url",t.cover_url),console.log("\u{1F4DD} Updating song:",e),this.http.put(`${this.API_URL}/songs/${e}/upload`,n)}deleteSong(e){return console.log("\u{1F5D1}\uFE0F Deleting song:",e),this.http.delete(`${this.API_URL}/songs/${e}`)}clearUploadState(){this.uploadProgress$.next(null),this.isUploading$.next(!1)}getAudioDuration(e){return new Promise((t,n)=>{let i=new Audio,s=URL.createObjectURL(e);i.addEventListener("loadedmetadata",()=>{URL.revokeObjectURL(s),t(i.duration)}),i.addEventListener("error",()=>{URL.revokeObjectURL(s),n(new Error("No se pudo cargar el archivo de audio"))}),i.src=s})}static \u0275fac=function(t){return new(t||r)(A($))};static \u0275prov=L({token:r,factory:r.\u0275fac,providedIn:"root"})};var ut=(r,e)=>({track:r,index:e}),ht=(r,e)=>({"uil-play":r,"uil-pause":e});function _t(r,e){r&1&&(o(0,"div",7)(1,"p"),d(2,"\u{1F3B5} Cargando playlist..."),a()())}function ft(r,e){if(r&1){let t=x();o(0,"div",8)(1,"p"),d(2),a(),o(3,"button",9),m("click",function(){u(t);let i=p();return h(i.retryLoad())}),d(4,"\u{1F504} Reintentar"),a()()}if(r&2){let t=p();l(2),k("\u274C ",t.error,"")}}function vt(r,e){r&1&&(o(0,"div",10)(1,"p"),d(2,"\u{1F4ED} No hay canciones disponibles"),a()())}function bt(r,e){r&1&&we(0)}function yt(r,e){if(r&1){let t=x();o(0,"ul",15),m("click",function(){let i=u(t).$implicit,s=p(2);return h(s.playTrack(i))}),o(1,"li",16),f(2,bt,1,0,"ng-container",17),a(),o(3,"li",18),d(4),a(),o(5,"li",18),d(6),a(),o(7,"li",18),d(8),a()()}if(r&2){let t=e.$implicit,n=e.index,i=p(2),s=K(6);pe("current-track",i.isCurrentTrack(t)),l(2),c("ngTemplateOutlet",s)("ngTemplateOutletContext",E(7,ut,t,n)),l(2),k(" ",t.album||"\xC1lbum desconocido"," "),l(2),k(" ",i.formatDate(t.created_at)," "),l(2),k(" ",i.formatDuration(t.duration)," ")}}function Ct(r,e){if(r&1){let t=x();o(0,"div")(1,"ul",11)(2,"li",12),m("click",function(){u(t);let i=p();return h(i.changeSort("name"))}),d(3," Nombre \u2764 "),a(),o(4,"li",12),m("click",function(){u(t);let i=p();return h(i.changeSort("album"))}),d(5," \xC1lbum \u{1F197} "),a(),o(6,"li"),d(7,"Fecha incorporaci\xF3n \u{1F34C}\u{1F601}"),a(),o(8,"li"),g(9,"i",13),a()(),f(10,yt,9,10,"ul",14),Y(11,"orderlist"),a()}if(r&2){let t=p();l(10),c("ngForOf",Q(11,1,t.tracks,t.optionSort.property,t.optionSort.order))}}function xt(r,e){if(r&1&&(o(0,"span",36),d(1),a()),r&2){let t=p().index;l(),v(t+1)}}function Pt(r,e){r&1&&g(0,"i",37)}function Mt(r,e){if(r&1){let t=x();o(0,"div",19)(1,"div",20),f(2,xt,2,1,"span",21)(3,Pt,1,0,"i",22),a(),g(4,"img",23),o(5,"div",24)(6,"div",25),d(7),a(),o(8,"div",26),d(9),a()(),o(10,"div",27)(11,"button",28),m("click",function(i){let s=u(t).track;return p().toggleFavorite(s),h(i.stopPropagation())}),g(12,"i",29),a(),o(13,"button",30),m("click",function(i){let s=u(t).track,_=p();return h(_.startEdit(s,i))}),g(14,"i",31),a(),o(15,"button",32),m("click",function(i){let s=u(t).track;return p().playTrack(s),h(i.stopPropagation())}),g(16,"i",33),a(),o(17,"button",34),m("click",function(i){let s=u(t).track,_=p();return h(_.deleteSong(s,i))}),g(18,"i",35),a()()()}if(r&2){let t=e.track,n=p();l(2),c("ngIf",!n.isCurrentTrack(t)),l(),c("ngIf",n.isCurrentTrack(t)),l(),c("src",t.cover_url,T)("alt",t.name),l(3),k(" ",t.name," "),l(2),k(" ",t.artist||"Artista desconocido"," "),l(2),pe("is-favorite",n.isFavorite(t)),c("title",n.isFavorite(t)?"Quitar de favoritos":"Agregar a favoritos"),l(4),c("title",n.isCurrentTrack(t)?"Pausar":"Reproducir"),l(),c("ngClass",E(11,ht,!n.isCurrentTrack(t),n.isCurrentTrack(t)))}}function Ot(r,e){if(r&1){let t=x();o(0,"div",58)(1,"img",59),m("error",function(i){u(t);let s=p(2);return h(s.onImageErrorHide(i))}),a()()}if(r&2){let t=p(2);l(),c("src",t.editForm.cover_url,T)}}function kt(r,e){if(r&1){let t=x();o(0,"div",38),m("click",function(){u(t);let i=p();return h(i.cancelEdit())}),o(1,"div",39),m("click",function(i){return u(t),h(i.stopPropagation())}),o(2,"div",40)(3,"h3"),d(4,"Editar informaci\xF3n"),a(),o(5,"button",41),m("click",function(){u(t);let i=p();return h(i.cancelEdit())}),g(6,"i",42),a()(),o(7,"div",43)(8,"div",44)(9,"label",45),d(10,"T\xEDtulo"),a(),o(11,"input",46),N("ngModelChange",function(i){u(t);let s=p();return H(s.editForm.title,i)||(s.editForm.title=i),h(i)}),a()(),o(12,"div",44)(13,"label",47),d(14,"Artista"),a(),o(15,"input",48),N("ngModelChange",function(i){u(t);let s=p();return H(s.editForm.artist,i)||(s.editForm.artist=i),h(i)}),a()(),o(16,"div",44)(17,"label",49),d(18,"\xC1lbum"),a(),o(19,"input",50),N("ngModelChange",function(i){u(t);let s=p();return H(s.editForm.album,i)||(s.editForm.album=i),h(i)}),a()(),o(20,"div",44)(21,"label",51),d(22,"URL de la car\xE1tula"),a(),o(23,"input",52),N("ngModelChange",function(i){u(t);let s=p();return H(s.editForm.cover_url,i)||(s.editForm.cover_url=i),h(i)}),a()(),f(24,Ot,2,1,"div",53),a(),o(25,"div",54)(26,"button",55),m("click",function(){u(t);let i=p();return h(i.cancelEdit())}),d(27," Cancelar "),a(),o(28,"button",56),m("click",function(){u(t);let i=p();return h(i.saveEdit())}),g(29,"i",57),d(30," Guardar cambios "),a()()()()}if(r&2){let t=p();l(11),D("ngModel",t.editForm.title),l(4),D("ngModel",t.editForm.artist),l(4),D("ngModel",t.editForm.album),l(4),D("ngModel",t.editForm.cover_url),l(),c("ngIf",t.editForm.cover_url),l(4),c("disabled",!(t.editForm.title!=null&&t.editForm.title.trim()))}}var se=class r{constructor(e,t,n,i,s){this.tracksService=e;this.multimediaService=t;this.favoritesService=n;this.musicUploadService=i;this.http=s}tracks=[];optionSort={property:null,order:"asc"};loading=!1;error=null;currentTrack=null;favoriteIds=[];editingTrack=null;editForm={};destroy$=new F;ngOnInit(){console.log("\u{1F3B5} PlayListBodyComponent initialized - Loading tracks from API"),this.loadTracks(),this.multimediaService.currentTrack.pipe(b(this.destroy$)).subscribe(e=>{this.currentTrack=e}),this.favoritesService.getUserFavorites().pipe(b(this.destroy$)).subscribe(e=>{console.log("\u{1F525} Favorites updated:",e),this.favoriteIds=e}),this.tracksService.tracksRefresh$.pipe(b(this.destroy$)).subscribe(e=>{e&&(console.log("\u{1F504} PlayListBody: Tracks refresh triggered, reloading..."),this.loadTracks())})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadTracks(){this.loading=!0,this.error=null,this.tracksService.getAllTracks().pipe(b(this.destroy$)).subscribe({next:e=>{console.log("\u2705 PlayListBody - Tracks loaded:",e?.length||0),this.tracks=e||[],this.loading=!1},error:e=>{console.error("\u274C PlayListBody - Error loading tracks:",e),this.error="Error al cargar las canciones",this.loading=!1,this.tracks=[]}})}playTrack(e){console.log("\u{1F3B5} Playing track from playlist:",e.name),this.multimediaService.setTrack(e),this.multimediaService.play()}isCurrentTrack(e){return this.currentTrack?._id===e._id}changeSort(e){let{order:t}=this.optionSort;this.optionSort={property:e,order:t==="asc"?"desc":"asc"},console.log("\u{1F504} Sort changed:",this.optionSort)}retryLoad(){console.log("\u{1F504} PlayListBody - Retry loading tracks"),this.loadTracks()}formatDuration(e){if(!e||isNaN(e))return"--:--";let t=Math.floor(e/60),n=Math.floor(e%60);return`${t}:${n.toString().padStart(2,"0")}`}formatDate(e){if(!e)return"Sin fecha";try{return new Date(e).toLocaleDateString("es-ES")}catch{return"Sin fecha"}}isFavorite(e){return this.favoriteIds.includes(e._id)}toggleFavorite(e){console.log("\u{1F525} Toggling favorite for track:",e.name,"ID:",e._id),this.favoritesService.toggleFavorite(e._id).subscribe({next:t=>{console.log("\u2705 Favorite toggled:",t?"Added":"Removed")},error:t=>{console.error("\u274C Error toggling favorite:",t)}})}startEdit(e,t){t.stopPropagation(),console.log("\u270F\uFE0F Starting edit for:",e.name),this.editingTrack=e,this.editForm={title:e.name,artist:e.artist,album:e.album,cover_url:e.cover_url}}cancelEdit(){this.editingTrack=null,this.editForm={}}saveEdit(){this.editingTrack&&(console.log("\u{1F4BE} Saving metadata changes for:",this.editingTrack.name),this.updateSongMetadata(Number(this.editingTrack._id),{title:this.editForm.title,artist:this.editForm.artist,album:this.editForm.album,cover_url:this.editForm.cover_url}).pipe(b(this.destroy$)).subscribe({next:e=>{console.log("\u2705 Song metadata updated successfully:",e);let t=this.tracks.findIndex(n=>n._id===this.editingTrack._id);t!==-1&&(this.tracks[t]=_e(he({},this.tracks[t]),{name:this.editForm.title,artist:this.editForm.artist,album:this.editForm.album,cover_url:this.editForm.cover_url})),this.cancelEdit()},error:e=>{console.error("\u274C Error updating song metadata:",e),this.error="Error al actualizar la informaci\xF3n de la canci\xF3n"}}))}updateSongMetadata(e,t){return this.http.put(`http://localhost:5000/api/music/songs/${e}/metadata`,t)}deleteSong(e,t){t.stopPropagation();let n=`\xBFEst\xE1s seguro de que quieres eliminar "${e.name}" permanentemente? Esta acci\xF3n no se puede deshacer.`;confirm(n)&&(console.log("\u{1F5D1}\uFE0F Deleting song:",e.name),this.musicUploadService.deleteSong(Number(e._id)).pipe(b(this.destroy$)).subscribe({next:i=>{console.log("\u2705 Song deleted successfully:",i),this.isFavorite(e)&&this.favoritesService.removeFromFavorites(Number(e._id)).pipe(b(this.destroy$)).subscribe({next:()=>{console.log("\u2705 Song removed from favorites")},error:s=>{console.error("\u274C Error removing from favorites:",s)}}),this.tracks=this.tracks.filter(s=>s._id!==e._id),this.tracksService.refreshTracks()},error:i=>{console.error("\u274C Error deleting song:",i),this.error="Error al eliminar la canci\xF3n"}}))}onImageError(e){let t=e.target;t.src="assets/img/default-cover.png"}onImageErrorHide(e){let t=e.target;t.style.display="none"}static \u0275fac=function(t){return new(t||r)(y(V),y(z),y(oe),y(ae),y($))};static \u0275cmp=O({type:r,selectors:[["app-play-list-body"]],decls:8,vars:5,consts:[["coverSection",""],[1,"play-list-body"],["class","loading-state",4,"ngIf"],["class","error-state",4,"ngIf"],["class","empty-state",4,"ngIf"],[4,"ngIf"],["class","edit-modal-overlay",3,"click",4,"ngIf"],[1,"loading-state"],[1,"error-state"],[1,"retry-btn",3,"click"],[1,"empty-state"],[1,"play-list-table-header"],[1,"sortable",3,"click"],[1,"uil","uil-clock-eight"],["class","play-list-rows",3,"current-track","click",4,"ngFor","ngForOf"],[1,"play-list-rows",3,"click"],[1,"track-name"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"track-name-opacity"],[1,"cover-section"],[1,"track-number"],["class","number",4,"ngIf"],["class","uil uil-volume current-playing",4,"ngIf"],[1,"cover-track",3,"src","alt"],[1,"cover-info"],[1,"name-track"],[1,"name-track-details"],[1,"track-actions"],[1,"favorite-btn",3,"click","title"],[1,"uil","uil-heart"],["title","Editar informaci\xF3n",1,"action-btn","edit-btn",3,"click"],[1,"uil","uil-edit"],[1,"play-btn",3,"click","title"],[1,"uil",3,"ngClass"],["title","Eliminar canci\xF3n permanentemente",1,"action-btn","delete-btn",3,"click"],[1,"uil","uil-trash-alt"],[1,"number"],[1,"uil","uil-volume","current-playing"],[1,"edit-modal-overlay",3,"click"],[1,"edit-modal",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click"],[1,"uil","uil-times"],[1,"modal-body"],[1,"form-group"],["for","trackTitle"],["type","text","id","trackTitle","placeholder","Nombre de la canci\xF3n",3,"ngModelChange","ngModel"],["for","trackArtist"],["type","text","id","trackArtist","placeholder","Nombre del artista",3,"ngModelChange","ngModel"],["for","trackAlbum"],["type","text","id","trackAlbum","placeholder","Nombre del \xE1lbum",3,"ngModelChange","ngModel"],["for","trackCover"],["type","url","id","trackCover","placeholder","https://ejemplo.com/cover.jpg",3,"ngModelChange","ngModel"],["class","cover-preview",4,"ngIf"],[1,"modal-footer"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-primary",3,"click","disabled"],[1,"uil","uil-check"],[1,"cover-preview"],["alt","Preview",3,"error","src"]],template:function(t,n){t&1&&(o(0,"div",1),f(1,_t,3,0,"div",2)(2,ft,5,1,"div",3)(3,vt,3,0,"div",4)(4,Ct,12,5,"div",5),a(),f(5,Mt,19,14,"ng-template",null,0,ze)(7,kt,31,6,"div",6)),t&2&&(l(),c("ngIf",n.loading),l(),c("ngIf",n.error),l(),c("ngIf",!n.loading&&!n.error&&n.tracks.length===0),l(),c("ngIf",!n.loading&&!n.error&&n.tracks.length>0),l(3),c("ngIf",n.editingTrack))},dependencies:[P,I,R,U,Fe,je,Ae,Ve,Be,re],styles:[".play-list-body[_ngcontent-%COMP%]{padding:.75rem;width:100%;max-width:100%;overflow-x:hidden;box-sizing:border-box}.play-list-table-header[_ngcontent-%COMP%]{width:100%;list-style:none;display:grid;grid-template-columns:3fr 2fr 2fr 1fr;margin:0;padding:0;font-size:90%;letter-spacing:1px;border-bottom:solid 1px var(--color-2);padding-bottom:.5rem;box-sizing:border-box;overflow:hidden}.play-list-table-header[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{text-transform:uppercase;color:var(--color-4);opacity:.7;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.play-list-rows[_ngcontent-%COMP%]{width:100%;list-style:none;display:grid;grid-template-columns:3fr 2fr 2fr 1fr;margin:0;padding:1rem 0 0;box-sizing:border-box;overflow:hidden}.play-list-rows[_ngcontent-%COMP%]   .track-name-opacity[_ngcontent-%COMP%]{opacity:.7;font-weight:300}.cover-section[_ngcontent-%COMP%]{display:flex;padding:0}.cover-section[_ngcontent-%COMP%]   .cover-track[_ngcontent-%COMP%]{width:40px;height:40px;object-fit:cover}.cover-section[_ngcontent-%COMP%]   .cover-info[_ngcontent-%COMP%]{padding:0 1rem}.cover-section[_ngcontent-%COMP%]   .cover-info[_ngcontent-%COMP%]   .name-track-details[_ngcontent-%COMP%]{font-size:80%;opacity:.7}.track-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;opacity:0;transition:opacity .2s ease}.play-list-rows[_ngcontent-%COMP%]:hover   .track-actions[_ngcontent-%COMP%]{opacity:1}.favorite-btn[_ngcontent-%COMP%]{background:none;border:none;color:#b3b3b3;cursor:pointer;padding:6px;border-radius:50%;transition:all .2s ease;font-size:1rem;width:32px;height:32px;display:flex;align-items:center;justify-content:center}.favorite-btn[_ngcontent-%COMP%]:hover{color:var(--color-1);background-color:#1db9541a}.favorite-btn.is-favorite[_ngcontent-%COMP%]{color:var(--color-1)}.favorite-btn.is-favorite[_ngcontent-%COMP%]:hover{color:#fff;background-color:var(--color-1)}.play-btn[_ngcontent-%COMP%]{background:var(--color-1);border:none;color:var(--color-3);cursor:pointer;width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1rem;transition:all .2s ease}.play-btn[_ngcontent-%COMP%]:hover{transform:scale(1.05);background-color:#1ed760}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{padding:2rem;text-align:center;color:#b3b3b3}.error-state[_ngcontent-%COMP%]{color:#ff6b6b}.retry-btn[_ngcontent-%COMP%]{background:var(--color-1);color:var(--color-3);border:none;padding:.5rem 1rem;border-radius:var(--border-radius-1);cursor:pointer;margin-top:1rem;transition:background-color .2s ease}.retry-btn[_ngcontent-%COMP%]:hover{background-color:#1ed760}.action-btn[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;padding:6px;border-radius:50%;transition:all .2s ease;font-size:1rem;width:32px;height:32px;display:flex;align-items:center;justify-content:center}.edit-btn[_ngcontent-%COMP%]{color:#3b82f6}.edit-btn[_ngcontent-%COMP%]:hover{color:#fff;background-color:#3b82f6}.delete-btn[_ngcontent-%COMP%]{color:#dc2626}.delete-btn[_ngcontent-%COMP%]:hover{color:#fff;background-color:#dc2626}.edit-modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#000000b3;display:flex;align-items:center;justify-content:center;z-index:1000;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px)}.edit-modal[_ngcontent-%COMP%]{background:var(--color-1);border-radius:12px;width:90%;max-width:500px;max-height:90vh;overflow-y:auto;box-shadow:0 20px 60px #0000004d;animation:_ngcontent-%COMP%_modalSlideIn .3s ease}@keyframes _ngcontent-%COMP%_modalSlideIn{0%{opacity:0;transform:translateY(-50px) scale(.9)}to{opacity:1;transform:translateY(0) scale(1)}}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1.5rem;border-bottom:1px solid var(--color-2)}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:var(--color-primary);font-size:1.5rem}.close-btn[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:var(--color-2);border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s ease;color:#fff}.close-btn[_ngcontent-%COMP%]:hover{background:#ff6b6b;transform:scale(1.1)}.modal-body[_ngcontent-%COMP%]{padding:1.5rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:600;color:var(--color-primary);font-size:.9rem}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:2px solid var(--color-2);border-radius:8px;background:transparent;color:var(--color-primary);font-size:1rem;transition:border-color .3s ease;box-sizing:border-box}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--color-4)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:var(--color-2)}.cover-preview[_ngcontent-%COMP%]{margin-top:1rem;text-align:center}.cover-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:150px;max-height:150px;border-radius:8px;object-fit:cover;box-shadow:0 4px 12px #0000001a}.modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem;padding:1.5rem;border-top:1px solid var(--color-2)}.btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;border-radius:8px;cursor:pointer;font-weight:600;transition:all .3s ease;display:flex;align-items:center;gap:.5rem;font-size:.9rem}.btn-secondary[_ngcontent-%COMP%]{background:var(--color-2);color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover{background:#666}.btn-primary[_ngcontent-%COMP%]{background:var(--color-4);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background:var(--color-3)}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn[_ngcontent-%COMP%]:disabled:hover{background:var(--color-4);transform:none}@media (max-width: 1024px){.play-list-body[_ngcontent-%COMP%]{padding:.75rem}.play-list-table-header[_ngcontent-%COMP%], .play-list-rows[_ngcontent-%COMP%]{grid-template-columns:50% 25% 15% 10%;gap:.5rem}.cover-section[_ngcontent-%COMP%]{gap:.5rem}.cover-track[_ngcontent-%COMP%]{width:40px;height:40px}.track-actions[_ngcontent-%COMP%]{gap:.25rem}.favorite-btn[_ngcontent-%COMP%], .action-btn[_ngcontent-%COMP%], .play-btn[_ngcontent-%COMP%]{width:28px;height:28px;font-size:.85rem}}@media (max-width: 768px){.play-list-body[_ngcontent-%COMP%]{padding:.5rem}.play-list-table-header[_ngcontent-%COMP%], .play-list-rows[_ngcontent-%COMP%]{grid-template-columns:70% 30%;gap:.5rem;padding:.5rem .25rem}.play-list-table-header[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(3), .play-list-table-header[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(4){display:none}.play-list-rows[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(3), .play-list-rows[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(4){display:none}.track-actions[_ngcontent-%COMP%]{opacity:1;position:absolute;right:.5rem;top:50%;transform:translateY(-50%);background:#000c;border-radius:15px;padding:.2rem;z-index:10}.play-list-rows[_ngcontent-%COMP%]{position:relative}.cover-track[_ngcontent-%COMP%]{width:35px;height:35px}.cover-section[_ngcontent-%COMP%]{gap:.4rem;width:calc(100% - 60px)}.cover-info[_ngcontent-%COMP%]{min-width:0;flex:1}.name-track[_ngcontent-%COMP%]{font-size:.9rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.name-track-details[_ngcontent-%COMP%]{font-size:.75rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.favorite-btn[_ngcontent-%COMP%], .action-btn[_ngcontent-%COMP%], .play-btn[_ngcontent-%COMP%]{width:26px;height:26px;font-size:.75rem;margin:0 1px}.edit-modal[_ngcontent-%COMP%]{width:95%;margin:1rem;max-height:90vh}.modal-header[_ngcontent-%COMP%], .modal-body[_ngcontent-%COMP%], .modal-footer[_ngcontent-%COMP%]{padding:1rem}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:.7rem;font-size:.9rem}.btn[_ngcontent-%COMP%]{padding:.7rem 1.2rem;font-size:.85rem}}@media (max-width: 480px){.play-list-body[_ngcontent-%COMP%]{padding:.25rem}.play-list-table-header[_ngcontent-%COMP%], .play-list-rows[_ngcontent-%COMP%]{grid-template-columns:100%;gap:0;padding:.25rem;position:relative}.play-list-table-header[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(2), .play-list-table-header[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(3), .play-list-table-header[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(4){display:none}.play-list-rows[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(2), .play-list-rows[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(3), .play-list-rows[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(4){display:none}.play-list-rows[_ngcontent-%COMP%]{border-bottom:1px solid rgba(255,255,255,.1);margin-bottom:.5rem;padding:.5rem .25rem;border-radius:6px;background:#ffffff05}.track-actions[_ngcontent-%COMP%]{position:absolute;right:.25rem;top:50%;transform:translateY(-50%);background:#000000e6;border-radius:12px;padding:.15rem;opacity:1;gap:.1rem;z-index:10}.favorite-btn[_ngcontent-%COMP%], .action-btn[_ngcontent-%COMP%], .play-btn[_ngcontent-%COMP%]{width:24px;height:24px;font-size:.7rem;margin:0}.cover-track[_ngcontent-%COMP%]{width:32px;height:32px}.cover-section[_ngcontent-%COMP%]{gap:.4rem;width:calc(100% - 70px)}.name-track[_ngcontent-%COMP%]{font-size:.85rem;margin-bottom:.1rem}.name-track-details[_ngcontent-%COMP%]{font-size:.7rem}.edit-modal[_ngcontent-%COMP%]{width:98%;margin:.5rem;max-height:95vh;border-radius:8px}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.1rem}.close-btn[_ngcontent-%COMP%]{width:32px;height:32px;font-size:.9rem}.modal-body[_ngcontent-%COMP%]{padding:.75rem}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:.6rem;font-size:.85rem}.btn[_ngcontent-%COMP%]{padding:.6rem 1rem;font-size:.8rem;flex:1}}@media (max-width: 360px){.play-list-body[_ngcontent-%COMP%]{padding:.15rem}.play-list-rows[_ngcontent-%COMP%]{padding:.4rem .15rem}.cover-track[_ngcontent-%COMP%]{width:28px;height:28px}.favorite-btn[_ngcontent-%COMP%], .action-btn[_ngcontent-%COMP%], .play-btn[_ngcontent-%COMP%]{width:22px;height:22px;font-size:.65rem}.name-track[_ngcontent-%COMP%]{font-size:.8rem}.name-track-details[_ngcontent-%COMP%]{font-size:.65rem}.track-actions[_ngcontent-%COMP%]{right:.15rem;padding:.1rem}.cover-section[_ngcontent-%COMP%]{width:calc(100% - 65px)}.edit-modal[_ngcontent-%COMP%]{width:100%;margin:0;border-radius:0;max-height:100vh}.btn[_ngcontent-%COMP%]{font-size:.75rem;padding:.5rem .75rem}}"]})};var qe=class r{static \u0275fac=function(t){return new(t||r)};static \u0275mod=Oe({type:r});static \u0275inj=Pe({imports:[P,Z,te,ne,B,ie,se,J]})};export{z as a,te as b,Z as c,V as d,ne as e,ie as f,ae as g,re as h,oe as i,se as j,qe as k};
