import{a as $,b as B,c as ee}from"./chunk-CB26HUFF.js";import{a as I,b as d,c as z,d as N,g as R,h as V,i as L,n as A,p as F}from"./chunk-L4RQEMSP.js";import{A as b,B as O,Ba as E,C as S,Da as T,Ga as M,J as s,L as _,M as y,Ma as Z,N as H,Qa as k,R as m,Ta as K,U as l,Y as o,Z as i,_ as g,aa as w,ba as u,ca as f,ha as a,ia as C,pa as h,v as U,z as x}from"./chunk-7N4HMWCM.js";var te=n=>({invalid:n});function pe(n,r){n&1&&(o(0,"div",19),a(1," Por favor ingresa un correo electr\xF3nico v\xE1lido "),i())}function le(n,r){n&1&&(o(0,"div",19),a(1," La contrase\xF1a debe tener al menos 6 caracteres "),i())}function ce(n,r){n&1&&(o(0,"span"),a(1,"Iniciar sesi\xF3n"),i())}function me(n,r){n&1&&(o(0,"span"),a(1,"Cargando..."),i())}function de(n,r){if(n&1){let e=w();o(0,"div",20)(1,"div",21)(2,"h3"),a(3),i(),o(4,"p"),a(5),i(),o(6,"button",22),u("click",function(){x(e);let p=f();return b(p.closePopup())}),a(7,"Aceptar"),i()()()}if(n&2){let e=f();s(),l("ngClass",e.popupType),s(2),C(e.popupTitle),s(2),C(e.popupMessage)}}var G=class n{constructor(r,e,t,p){this.fb=r;this.router=e;this.userService=t;this.apiService=p;this.loginForm=this.fb.group({email:["",[d.required,d.email]],password:["",[d.required,d.minLength(6)]]})}loginForm;loading=!1;showPopup=!1;popupTitle="";popupMessage="";popupType="success";ngOnInit(){this.userService.isAuthenticated()&&this.router.navigate(["/home"])}onLogin(){this.loginForm.invalid||(this.loading=!0,this.apiService.post("/api/users/login",this.loginForm.value).subscribe({next:r=>{this.userService.setCurrentUser(r.user),this.showSuccessPopup("Inicio de sesi\xF3n exitoso","Bienvenido a Polimusic"),setTimeout(()=>{this.router.navigate(["/home"])},1500)},error:r=>{r.status===401?this.showErrorPopup("Error de autenticaci\xF3n","Correo electr\xF3nico o contrase\xF1a incorrectos"):this.showErrorPopup("Error","Ocurri\xF3 un error al intentar iniciar sesi\xF3n"),this.loading=!1},complete:()=>{this.loading=!1}}))}goToRegister(){this.router.navigate(["/auth/register"])}goToForgotPassword(){this.router.navigate(["/auth/forgot-password"])}showSuccessPopup(r,e){this.popupTitle=r,this.popupMessage=e,this.popupType="success",this.showPopup=!0}showErrorPopup(r,e){this.popupTitle=r,this.popupMessage=e,this.popupType="error",this.showPopup=!0}closePopup(){this.showPopup=!1}static \u0275fac=function(e){return new(e||n)(_(A),_(k),_($),_(B))};static \u0275cmp=y({type:n,selectors:[["app-login-page"]],decls:32,vars:13,consts:[[1,"login-container"],[1,"login-card"],[1,"logo-container"],["viewBox","0 0 24 24",1,"spotify-logo"],["d","M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"],[1,"login-form",3,"ngSubmit","formGroup"],[1,"form-group"],["for","email"],["type","email","id","email","formControlName","email","placeholder","Correo electr\xF3nico",3,"ngClass"],["class","error-message",4,"ngIf"],["for","password"],["type","password","id","password","formControlName","password","placeholder","Contrase\xF1a",3,"ngClass"],["type","submit",1,"login-button",3,"disabled"],[4,"ngIf"],[1,"divider"],[1,"register-link"],[3,"click"],[1,"forgot-password"],["class","popup-overlay",4,"ngIf"],[1,"error-message"],[1,"popup-overlay"],[1,"popup-content",3,"ngClass"],[1,"popup-button",3,"click"]],template:function(e,t){if(e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2),O(),o(3,"svg",3),g(4,"path",4),i(),S(),o(5,"h1"),a(6,"Polimusic"),i()(),o(7,"form",5),u("ngSubmit",function(){return t.onLogin()}),o(8,"h2"),a(9,"Inicia sesi\xF3n en Polimusic"),i(),o(10,"div",6)(11,"label",7),a(12,"Correo electr\xF3nico"),i(),g(13,"input",8),m(14,pe,2,0,"div",9),i(),o(15,"div",6)(16,"label",10),a(17,"Contrase\xF1a"),i(),g(18,"input",11),m(19,le,2,0,"div",9),i(),o(20,"button",12),m(21,ce,2,0,"span",13)(22,me,2,0,"span",13),i(),g(23,"div",14),o(24,"p",15),a(25," \xBFNo tienes una cuenta? "),o(26,"a",16),u("click",function(){return t.goToRegister()}),a(27,"Reg\xEDstrate en Polimusic"),i()(),o(28,"p",17)(29,"a",16),u("click",function(){return t.goToForgotPassword()}),a(30,"\xBFOlvidaste tu contrase\xF1a?"),i()()()(),m(31,de,8,3,"div",18),i()),e&2){let p,v,c,P;s(7),l("formGroup",t.loginForm),s(6),l("ngClass",h(9,te,((p=t.loginForm.get("email"))==null?null:p.invalid)&&((p=t.loginForm.get("email"))==null?null:p.touched))),s(),l("ngIf",((v=t.loginForm.get("email"))==null?null:v.invalid)&&((v=t.loginForm.get("email"))==null?null:v.touched)),s(4),l("ngClass",h(11,te,((c=t.loginForm.get("password"))==null?null:c.invalid)&&((c=t.loginForm.get("password"))==null?null:c.touched))),s(),l("ngIf",((P=t.loginForm.get("password"))==null?null:P.invalid)&&((P=t.loginForm.get("password"))==null?null:P.touched)),s(),l("disabled",t.loginForm.invalid||t.loading),s(),l("ngIf",!t.loading),s(),l("ngIf",t.loading),s(9),l("ngIf",t.showPopup)}},dependencies:[M,E,T,F,R,I,z,N,V,L],styles:[".login-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background-color:#000;color:#fff;padding:20px}.login-card[_ngcontent-%COMP%]{background-color:#121212;border-radius:8px;padding:32px;width:100%;max-width:450px;box-shadow:0 4px 60px #00000080}.logo-container[_ngcontent-%COMP%]{text-align:center;margin-bottom:32px}.spotify-logo[_ngcontent-%COMP%]{width:48px;height:48px;fill:#1db954;margin-bottom:16px}.login-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:28px;margin-bottom:28px;text-align:center;font-weight:700}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-size:14px;font-weight:700}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:12px;border-radius:4px;border:1px solid #535353;background-color:#121212;color:#fff;font-size:16px}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#1db954;outline:none}.form-group[_ngcontent-%COMP%]   input.invalid[_ngcontent-%COMP%]{border-color:#e91429}.error-message[_ngcontent-%COMP%]{color:#e91429;font-size:12px;margin-top:4px}.login-button[_ngcontent-%COMP%]{width:100%;padding:12px;border-radius:500px;background-color:#1db954;color:#fff;font-weight:700;font-size:16px;border:none;cursor:pointer;margin-top:20px;transition:all .3s ease}.login-button[_ngcontent-%COMP%]:hover{background-color:#1ed760;transform:scale(1.02)}.login-button[_ngcontent-%COMP%]:disabled{background-color:#535353;cursor:not-allowed;transform:none}.divider[_ngcontent-%COMP%]{height:1px;background-color:#282828;margin:32px 0}.register-link[_ngcontent-%COMP%], .forgot-password[_ngcontent-%COMP%]{text-align:center;font-size:14px;color:#b3b3b3}.register-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .forgot-password[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-decoration:underline;cursor:pointer}.register-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .forgot-password[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#1db954}.popup-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#000000b3;display:flex;justify-content:center;align-items:center;z-index:1000}.popup-content[_ngcontent-%COMP%]{background-color:#282828;padding:24px;border-radius:8px;max-width:400px;width:90%;text-align:center}.popup-content.success[_ngcontent-%COMP%]{border-top:4px solid #1DB954}.popup-content.error[_ngcontent-%COMP%]{border-top:4px solid #e91429}.popup-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;font-size:20px}.popup-button[_ngcontent-%COMP%]{background-color:#1db954;color:#fff;border:none;padding:10px 20px;border-radius:500px;cursor:pointer;font-weight:700;margin-top:16px}.popup-button[_ngcontent-%COMP%]:hover{background-color:#1ed760}"]})};var Q=n=>({invalid:n});function ge(n,r){n&1&&(o(0,"div",20),a(1," Por favor ingresa un correo electr\xF3nico v\xE1lido "),i())}function ue(n,r){n&1&&(o(0,"div",20),a(1," La contrase\xF1a debe tener al menos 6 caracteres "),i())}function fe(n,r){n&1&&(o(0,"div",20),a(1," Las contrase\xF1as no coinciden "),i())}function _e(n,r){n&1&&(o(0,"span"),a(1,"Registrarse"),i())}function ve(n,r){n&1&&(o(0,"span"),a(1,"Cargando..."),i())}function he(n,r){if(n&1){let e=w();o(0,"div",21)(1,"div",22)(2,"h3"),a(3),i(),o(4,"p"),a(5),i(),o(6,"button",23),u("click",function(){x(e);let p=f();return b(p.closePopup())}),a(7,"Aceptar"),i()()()}if(n&2){let e=f();s(),l("ngClass",e.popupType),s(2),C(e.popupTitle),s(2),C(e.popupMessage)}}var D=class n{constructor(r,e,t){this.fb=r;this.router=e;this.apiService=t;this.registerForm=this.fb.group({email:["",[d.required,d.email]],password:["",[d.required,d.minLength(6)]],confirmPassword:["",[d.required]]},{validator:this.passwordMatchValidator})}registerForm;loading=!1;showPopup=!1;popupTitle="";popupMessage="";popupType="success";ngOnInit(){}passwordMatchValidator(r){let e=r.get("password")?.value,t=r.get("confirmPassword")?.value;return e===t?null:{mismatch:!0}}onRegister(){if(this.registerForm.invalid)return;this.loading=!0;let{email:r,password:e}=this.registerForm.value;this.apiService.post("/api/users",{email:r,password:e}).subscribe({next:t=>{this.showSuccessPopup("Registro exitoso","Tu cuenta ha sido creada correctamente. Ahora puedes iniciar sesi\xF3n."),setTimeout(()=>{this.router.navigate(["/auth/login"])},1500)},error:t=>{t.status===400&&t.error.message==="Email already exists"?this.showErrorPopup("Error de registro","Este correo electr\xF3nico ya est\xE1 en uso"):this.showErrorPopup("Error","Ocurri\xF3 un error al intentar registrarte"),this.loading=!1},complete:()=>{this.loading=!1}})}goToLogin(){this.router.navigate(["/auth/login"])}showSuccessPopup(r,e){this.popupTitle=r,this.popupMessage=e,this.popupType="success",this.showPopup=!0}showErrorPopup(r,e){this.popupTitle=r,this.popupMessage=e,this.popupType="error",this.showPopup=!0}closePopup(){this.showPopup=!1}static \u0275fac=function(e){return new(e||n)(_(A),_(k),_(B))};static \u0275cmp=y({type:n,selectors:[["app-register-page"]],decls:34,vars:17,consts:[[1,"register-container"],[1,"register-card"],[1,"logo-container"],["viewBox","0 0 24 24",1,"spotify-logo"],["d","M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"],[1,"register-form",3,"ngSubmit","formGroup"],[1,"form-group"],["for","email"],["type","email","id","email","formControlName","email","placeholder","Correo electr\xF3nico",3,"ngClass"],["class","error-message",4,"ngIf"],["for","password"],["type","password","id","password","formControlName","password","placeholder","Contrase\xF1a",3,"ngClass"],["for","confirmPassword"],["type","password","id","confirmPassword","formControlName","confirmPassword","placeholder","Confirmar contrase\xF1a",3,"ngClass"],["type","submit",1,"register-button",3,"disabled"],[4,"ngIf"],[1,"divider"],[1,"login-link"],[3,"click"],["class","popup-overlay",4,"ngIf"],[1,"error-message"],[1,"popup-overlay"],[1,"popup-content",3,"ngClass"],[1,"popup-button",3,"click"]],template:function(e,t){if(e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2),O(),o(3,"svg",3),g(4,"path",4),i(),S(),o(5,"h1"),a(6,"Polimusic"),i()(),o(7,"form",5),u("ngSubmit",function(){return t.onRegister()}),o(8,"h2"),a(9,"Reg\xEDstrate en Polimusic"),i(),o(10,"div",6)(11,"label",7),a(12,"Correo electr\xF3nico"),i(),g(13,"input",8),m(14,ge,2,0,"div",9),i(),o(15,"div",6)(16,"label",10),a(17,"Contrase\xF1a"),i(),g(18,"input",11),m(19,ue,2,0,"div",9),i(),o(20,"div",6)(21,"label",12),a(22,"Confirmar contrase\xF1a"),i(),g(23,"input",13),m(24,fe,2,0,"div",9),i(),o(25,"button",14),m(26,_e,2,0,"span",15)(27,ve,2,0,"span",15),i(),g(28,"div",16),o(29,"p",17),a(30," \xBFYa tienes una cuenta? "),o(31,"a",18),u("click",function(){return t.goToLogin()}),a(32,"Inicia sesi\xF3n"),i()()()(),m(33,he,8,3,"div",19),i()),e&2){let p,v,c,P,q,X;s(7),l("formGroup",t.registerForm),s(6),l("ngClass",h(11,Q,((p=t.registerForm.get("email"))==null?null:p.invalid)&&((p=t.registerForm.get("email"))==null?null:p.touched))),s(),l("ngIf",((v=t.registerForm.get("email"))==null?null:v.invalid)&&((v=t.registerForm.get("email"))==null?null:v.touched)),s(4),l("ngClass",h(13,Q,((c=t.registerForm.get("password"))==null?null:c.invalid)&&((c=t.registerForm.get("password"))==null?null:c.touched))),s(),l("ngIf",((P=t.registerForm.get("password"))==null?null:P.invalid)&&((P=t.registerForm.get("password"))==null?null:P.touched)),s(4),l("ngClass",h(15,Q,(((q=t.registerForm.get("confirmPassword"))==null?null:q.invalid)||t.registerForm.hasError("mismatch"))&&((q=t.registerForm.get("confirmPassword"))==null?null:q.touched))),s(),l("ngIf",t.registerForm.hasError("mismatch")&&((X=t.registerForm.get("confirmPassword"))==null?null:X.touched)),s(),l("disabled",t.registerForm.invalid||t.loading),s(),l("ngIf",!t.loading),s(),l("ngIf",t.loading),s(6),l("ngIf",t.showPopup)}},dependencies:[M,E,T,F,R,I,z,N,V,L],styles:[".register-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background-color:#000;color:#fff;padding:20px}.register-card[_ngcontent-%COMP%]{background-color:#121212;border-radius:8px;padding:32px;width:100%;max-width:450px;box-shadow:0 4px 60px #00000080}.logo-container[_ngcontent-%COMP%]{text-align:center;margin-bottom:32px}.spotify-logo[_ngcontent-%COMP%]{width:48px;height:48px;fill:#1db954;margin-bottom:16px}.register-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:28px;margin-bottom:28px;text-align:center;font-weight:700}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-size:14px;font-weight:700}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:12px;border-radius:4px;border:1px solid #535353;background-color:#121212;color:#fff;font-size:16px}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#1db954;outline:none}.form-group[_ngcontent-%COMP%]   input.invalid[_ngcontent-%COMP%]{border-color:#e91429}.error-message[_ngcontent-%COMP%]{color:#e91429;font-size:12px;margin-top:4px}.register-button[_ngcontent-%COMP%]{width:100%;padding:12px;border-radius:500px;background-color:#1db954;color:#fff;font-weight:700;font-size:16px;border:none;cursor:pointer;margin-top:20px;transition:all .3s ease}.register-button[_ngcontent-%COMP%]:hover{background-color:#1ed760;transform:scale(1.02)}.register-button[_ngcontent-%COMP%]:disabled{background-color:#535353;cursor:not-allowed;transform:none}.divider[_ngcontent-%COMP%]{height:1px;background-color:#282828;margin:32px 0}.login-link[_ngcontent-%COMP%]{text-align:center;font-size:14px;color:#b3b3b3}.login-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-decoration:underline;cursor:pointer}.login-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#1db954}.popup-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#000000b3;display:flex;justify-content:center;align-items:center;z-index:1000}.popup-content[_ngcontent-%COMP%]{background-color:#282828;padding:24px;border-radius:8px;max-width:400px;width:90%;text-align:center}.popup-content.success[_ngcontent-%COMP%]{border-top:4px solid #1DB954}.popup-content.error[_ngcontent-%COMP%]{border-top:4px solid #e91429}.popup-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;font-size:20px}.popup-button[_ngcontent-%COMP%]{background-color:#1db954;color:#fff;border:none;padding:10px 20px;border-radius:500px;cursor:pointer;font-weight:700;margin-top:16px}.popup-button[_ngcontent-%COMP%]:hover{background-color:#1ed760}@media (max-width: 480px){.register-card[_ngcontent-%COMP%]{padding:24px}.register-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;margin-bottom:24px}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .register-button[_ngcontent-%COMP%]{padding:10px;font-size:14px}}"]})};var W=n=>({invalid:n});function Ce(n,r){n&1&&(o(0,"div",17),a(1," Por favor ingresa un correo electr\xF3nico v\xE1lido "),i())}function Pe(n,r){n&1&&(o(0,"span"),a(1,"Verificar Email"),i())}function xe(n,r){n&1&&(o(0,"span"),a(1,"Verificando..."),i())}function be(n,r){if(n&1){let e=w();o(0,"div",9)(1,"h2"),a(2,"Recuperar Contrase\xF1a"),i(),o(3,"p"),a(4,"Ingresa tu correo electr\xF3nico para verificar tu cuenta."),i(),o(5,"form",10),u("ngSubmit",function(){x(e);let p=f();return b(p.onSubmitEmail())}),o(6,"div",11)(7,"label",12),a(8,"Correo Electr\xF3nico"),i(),g(9,"input",13),m(10,Ce,2,0,"div",14),i(),o(11,"button",15),m(12,Pe,2,0,"span",16)(13,xe,2,0,"span",16),i()()()}if(n&2){let e,t,p=f();s(5),l("formGroup",p.emailForm),s(4),l("ngClass",h(6,W,((e=p.emailForm.get("email"))==null?null:e.invalid)&&((e=p.emailForm.get("email"))==null?null:e.touched))),s(),l("ngIf",((t=p.emailForm.get("email"))==null?null:t.invalid)&&((t=p.emailForm.get("email"))==null?null:t.touched)),s(),l("disabled",p.emailForm.invalid||p.loading),s(),l("ngIf",!p.loading),s(),l("ngIf",p.loading)}}function we(n,r){n&1&&(o(0,"div",17),a(1," La contrase\xF1a debe tener al menos 6 caracteres "),i())}function Me(n,r){n&1&&(o(0,"div",17),a(1," Las contrase\xF1as no coinciden "),i())}function Fe(n,r){n&1&&(o(0,"span"),a(1,"Actualizar Contrase\xF1a"),i())}function Oe(n,r){n&1&&(o(0,"span"),a(1,"Actualizando..."),i())}function Se(n,r){if(n&1){let e=w();o(0,"div",9)(1,"h2"),a(2,"Nueva Contrase\xF1a"),i(),o(3,"p"),a(4,"Establece tu nueva contrase\xF1a para "),o(5,"strong"),a(6),i()(),o(7,"form",10),u("ngSubmit",function(){x(e);let p=f();return b(p.onSubmitReset())}),o(8,"div",11)(9,"label",18),a(10,"Nueva Contrase\xF1a"),i(),g(11,"input",19),m(12,we,2,0,"div",14),i(),o(13,"div",11)(14,"label",20),a(15,"Confirmar Contrase\xF1a"),i(),g(16,"input",21),m(17,Me,2,0,"div",14),i(),o(18,"button",15),m(19,Fe,2,0,"span",16)(20,Oe,2,0,"span",16),i(),o(21,"button",22),u("click",function(){x(e);let p=f();return b(p.goBackToEmail())}),a(22," Cambiar Email "),i()()()}if(n&2){let e,t,p,v,c=f();s(6),C(c.verifiedEmail),s(),l("formGroup",c.resetForm),s(4),l("ngClass",h(9,W,((e=c.resetForm.get("newPassword"))==null?null:e.invalid)&&((e=c.resetForm.get("newPassword"))==null?null:e.touched))),s(),l("ngIf",((t=c.resetForm.get("newPassword"))==null?null:t.invalid)&&((t=c.resetForm.get("newPassword"))==null?null:t.touched)),s(4),l("ngClass",h(11,W,(((p=c.resetForm.get("confirmPassword"))==null?null:p.invalid)||c.resetForm.hasError("mismatch"))&&((p=c.resetForm.get("confirmPassword"))==null?null:p.touched))),s(),l("ngIf",c.resetForm.hasError("mismatch")&&((v=c.resetForm.get("confirmPassword"))==null?null:v.touched)),s(),l("disabled",c.resetForm.invalid||c.loading),s(),l("ngIf",!c.loading),s(),l("ngIf",c.loading)}}function ye(n,r){if(n&1){let e=w();o(0,"div",23)(1,"div",24)(2,"h3"),a(3),i(),o(4,"p"),a(5),i(),o(6,"button",25),u("click",function(){x(e);let p=f();return b(p.closePopup())}),a(7,"Aceptar"),i()()()}if(n&2){let e=f();s(),l("ngClass",e.popupType),s(2),C(e.popupTitle),s(2),C(e.popupMessage)}}var j=class n{constructor(r,e,t){this.fb=r;this.router=e;this.authService=t;this.emailForm=this.fb.group({email:["",[d.required,d.email]]}),this.resetForm=this.fb.group({newPassword:["",[d.required,d.minLength(6)]],confirmPassword:["",[d.required]]},{validator:this.passwordMatchValidator})}emailForm;resetForm;loading=!1;showPopup=!1;popupTitle="";popupMessage="";popupType="success";step=1;verifiedEmail="";ngOnInit(){}passwordMatchValidator(r){let e=r.get("newPassword")?.value,t=r.get("confirmPassword")?.value;return e===t?null:{mismatch:!0}}onSubmitEmail(){if(this.emailForm.invalid)return;this.loading=!0;let r=this.emailForm.get("email")?.value;this.authService.verifyEmail(r).subscribe({next:e=>{e.success&&(this.verifiedEmail=r,this.step=2,this.showSuccessPopup("Email verificado","Ahora puedes establecer tu nueva contrase\xF1a."))},error:e=>{e.status===404?this.showErrorPopup("Usuario no encontrado","No existe una cuenta con este correo electr\xF3nico."):this.showErrorPopup("Error","Ocurri\xF3 un error al verificar el correo electr\xF3nico.")},complete:()=>{this.loading=!1}})}onSubmitReset(){if(this.resetForm.invalid)return;this.loading=!0;let r=this.resetForm.get("newPassword")?.value;this.authService.resetPassword(this.verifiedEmail,r).subscribe({next:e=>{e.success&&(this.showSuccessPopup("Contrase\xF1a actualizada","Tu contrase\xF1a ha sido actualizada correctamente. Ahora puedes iniciar sesi\xF3n."),setTimeout(()=>{this.router.navigate(["/auth/login"])},2e3))},error:e=>{this.showErrorPopup("Error","Ocurri\xF3 un error al actualizar la contrase\xF1a.")},complete:()=>{this.loading=!1}})}goBackToEmail(){this.step=1,this.resetForm.reset()}goToLogin(){this.router.navigate(["/auth/login"])}showSuccessPopup(r,e){this.popupTitle=r,this.popupMessage=e,this.popupType="success",this.showPopup=!0}showErrorPopup(r,e){this.popupTitle=r,this.popupMessage=e,this.popupType="error",this.showPopup=!0}closePopup(){this.showPopup=!1}static \u0275fac=function(e){return new(e||n)(_(A),_(k),_(ee))};static \u0275cmp=y({type:n,selectors:[["app-forgot-password-page"]],decls:15,vars:3,consts:[[1,"forgot-password-container"],[1,"forgot-password-card"],[1,"logo-container"],["viewBox","0 0 24 24",1,"spotify-logo"],["d","M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15.18 10.14 18.72 12.36c.42.24.6.78.24 1.68z"],["class","forgot-password-form",4,"ngIf"],["class","popup-overlay",4,"ngIf"],[1,"login-link"],[3,"click"],[1,"forgot-password-form"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","email"],["type","email","id","email","formControlName","email","placeholder","Ingresa tu correo",3,"ngClass"],["class","error-message",4,"ngIf"],["type","submit",1,"submit-button",3,"disabled"],[4,"ngIf"],[1,"error-message"],["for","newPassword"],["type","password","id","newPassword","formControlName","newPassword","placeholder","Nueva contrase\xF1a",3,"ngClass"],["for","confirmPassword"],["type","password","id","confirmPassword","formControlName","confirmPassword","placeholder","Confirmar contrase\xF1a",3,"ngClass"],["type","button",1,"back-button",3,"click"],[1,"popup-overlay"],[1,"popup-content",3,"ngClass"],[1,"popup-button",3,"click"]],template:function(e,t){e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2),O(),o(3,"svg",3),g(4,"path",4),i(),S(),o(5,"h1"),a(6,"Polimusic"),i()(),m(7,be,14,8,"div",5)(8,Se,23,13,"div",5)(9,ye,8,3,"div",6),o(10,"div",7)(11,"p"),a(12,"\xBFRecuerdas tu contrase\xF1a? "),o(13,"a",8),u("click",function(){return t.goToLogin()}),a(14,"Inicia sesi\xF3n aqu\xED"),i()()()()()),e&2&&(s(7),l("ngIf",t.step===1),s(),l("ngIf",t.step===2),s(),l("ngIf",t.showPopup))},dependencies:[M,E,T,F,R,I,z,N,V,L],styles:[".forgot-password-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background-color:#000;color:#fff;padding:20px}.forgot-password-card[_ngcontent-%COMP%]{background-color:#121212;border-radius:8px;padding:32px;width:100%;max-width:450px;box-shadow:0 4px 60px #00000080}.logo-container[_ngcontent-%COMP%]{text-align:center;margin-bottom:32px}.spotify-logo[_ngcontent-%COMP%]{width:48px;height:48px;fill:#1db954;margin-bottom:16px}.forgot-password-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:28px;margin-bottom:16px;text-align:center;font-weight:700}.forgot-password-form[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;color:#b3b3b3;margin-bottom:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-size:14px;font-weight:700}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:12px;border-radius:4px;border:1px solid #535353;background-color:#121212;color:#fff;font-size:16px}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#1db954;outline:none}.form-group[_ngcontent-%COMP%]   input.invalid[_ngcontent-%COMP%]{border-color:#e91429}.error-message[_ngcontent-%COMP%]{color:#e91429;font-size:12px;margin-top:4px}.submit-button[_ngcontent-%COMP%]{width:100%;padding:12px;border-radius:500px;background-color:#1db954;color:#fff;font-weight:700;font-size:16px;border:none;cursor:pointer;margin-top:20px;transition:all .3s ease}.submit-button[_ngcontent-%COMP%]:hover{background-color:#1ed760;transform:scale(1.02)}.submit-button[_ngcontent-%COMP%]:disabled{background-color:#535353;cursor:not-allowed;transform:none}.back-button[_ngcontent-%COMP%]{width:100%;padding:12px;border-radius:500px;background-color:transparent;color:#1db954;font-weight:700;font-size:16px;border:2px solid #1DB954;cursor:pointer;margin-top:16px;transition:all .3s ease}.back-button[_ngcontent-%COMP%]:hover{background-color:#1db954;color:#fff;transform:scale(1.02)}.login-link[_ngcontent-%COMP%]{text-align:center;font-size:14px;color:#b3b3b3;margin-top:24px}.login-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-decoration:underline;cursor:pointer}.login-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#1db954}.popup-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#000000b3;display:flex;justify-content:center;align-items:center;z-index:1000}.popup-content[_ngcontent-%COMP%]{background-color:#282828;padding:24px;border-radius:8px;max-width:400px;width:90%;text-align:center}.popup-content.success[_ngcontent-%COMP%]{border-top:4px solid #1DB954}.popup-content.error[_ngcontent-%COMP%]{border-top:4px solid #e91429}.popup-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;font-size:20px}.popup-button[_ngcontent-%COMP%]{background-color:#1db954;color:#fff;border:none;padding:10px 20px;border-radius:500px;cursor:pointer;font-weight:700;margin-top:16px}.popup-button[_ngcontent-%COMP%]:hover{background-color:#1ed760}@media (max-width: 768px){.forgot-password-card[_ngcontent-%COMP%]{padding:24px}.forgot-password-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;margin-bottom:24px}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .submit-button[_ngcontent-%COMP%], .back-button[_ngcontent-%COMP%]{padding:10px;font-size:14px}}"]})};var Ee=[{path:"login",component:G},{path:"register",component:D},{path:"forgot-password",component:j},{path:"",redirectTo:"login",pathMatch:"full"}],J=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=H({type:n});static \u0275inj=U({imports:[K.forChild(Ee),K]})};var ae=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=H({type:n});static \u0275inj=U({providers:[B],imports:[M,J,F,Z,G,D,j]})};export{ae as AuthModule};
